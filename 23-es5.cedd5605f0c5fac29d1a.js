function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"+eMj":function(e,t,n){"use strict";n.r(t);var r=n("ofXK"),i=n("3Pt+"),s=n("tyNb"),a=n("c7TG"),o=n("mrSG"),u=n("LTmD"),c=n("PKx9"),h=n("Y6BA"),f=n("HULg"),l=n("lEof"),p=n("fXoL");function g(e,t){if(1&e&&(p.ec(0,"ion-menu-toggle",6),p.ec(1,"ion-item",7),p.ac(2,"ion-icon",8),p.ec(3,"ion-label"),p.Hc(4),p.dc(),p.dc(),p.dc()),2&e){var n=t.$implicit,r=p.pc();p.Nb(1),p.Qb("active-item",r.selectedPath.startsWith(n.url)),p.uc("routerLink",n.url),p.Nb(1),p.uc("name",n.icon),p.Nb(2),p.Jc(" ",n.title," ")}}var d,m=((d=function(){function e(t,n,r,i,s,a,o){_classCallCheck(this,e),this.router=t,this.platform=n,this.toastController=r,this.forumservice=i,this.host=s,this.nanodb=a,this.settings=o,this.selectedPath="",this.pages=[{title:"\u6392\u76d8",url:"/menu/paipan",icon:"home"},{title:"\u7f57\u76d8",url:"/menu/compass",icon:"disc"},{title:"\u6848\u4f8b",url:"/menu/nodes",icon:"list"},{title:"\u8ba8\u8bba\u533a",url:"/menu/forum",icon:"chatbubbles"},{title:"\u7528\u6237",url:"/menu/user",icon:"person"},{title:"\u8bbe\u7f6e",url:"/menu/setting",icon:"settings"}],this.IsWebApp=!1}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.settings.WaitInit();case 2:this.platform.platforms(),this.nanodb.initNano(),navigator.app||(this.IsWebApp=!0),this.settings.HasUser&&this.settings.User.id!==h.a.id&&(this.updateAppSetting(),this.forumservice.HoldPublicMessage().then((function(e){e>0&&t.presentToast("\u60a8\u6709 ".concat(e," \u6761\u672a\u8bfb\u6d88\u606f, \u8bf7\u53ca\u65f6\u67e5\u6536\u3002"),5e3)})),this.pages.insert(3,{title:"\u6211\u7684\u6d88\u606f",url:"/menu/messagelist/false",icon:"chatboxes"}));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"updateAppSetting",value:function(){var e=this;this.host.GetAppSetting().then((function(t){e.settings.AppConfig.appSetting=t.appSetting})).catch((function(e){console.log("Get AppSetting failed",e)}))}},{key:"closeApp",value:function(){navigator.app?navigator.app.exitApp():console.log("platforms",this.platform.platforms(),navigator)}},{key:"presentToast",value:function(e,t){return Object(o.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.toastController.create({message:e,duration:t,color:"secondary",position:"middle"});case 2:n.sent.present();case 3:case"end":return n.stop()}}),n,this)})))}},{key:"HasUser",get:function(){return this.settings.HasUser}}]),e}()).\u0275fac=function(e){return new(e||d)(p.Zb(s.g),p.Zb(a.hb),p.Zb(a.mb),p.Zb(c.a),p.Zb(l.a),p.Zb(f.a),p.Zb(u.a))},d.\u0275cmp=p.Tb({type:d,selectors:[["app-menu"]],viewQuery:function(e,t){var n;1&e&&p.Mc(s.j,!0),2&e&&p.wc(n=p.nc())&&(t.outlet=n.first)},decls:13,vars:2,consts:[["disabled","true","contentId","content"],["contentId","content"],["auto-hide","false",4,"ngFor","ngForOf"],["tappable","",3,"hidden","click"],["name","exit","slot","start"],["id","content"],["auto-hide","false"],["routerDirection","root",3,"routerLink"],["slot","start",3,"name"]],template:function(e,t){1&e&&(p.ec(0,"ion-split-pane",0),p.ec(1,"ion-menu",1),p.ec(2,"ion-header"),p.ec(3,"ion-toolbar"),p.ec(4,"ion-text"),p.Hc(5,"\u83dc\u5355"),p.dc(),p.dc(),p.dc(),p.ec(6,"ion-content"),p.ec(7,"ion-list"),p.Fc(8,g,5,5,"ion-menu-toggle",2),p.ec(9,"ion-item",3),p.mc("click",(function(){return t.closeApp()})),p.ac(10,"ion-icon",4),p.Hc(11," \u9000\u51fa "),p.dc(),p.dc(),p.dc(),p.dc(),p.ac(12,"ion-router-outlet",5),p.dc()),2&e&&(p.Nb(8),p.uc("ngForOf",t.pages),p.Nb(1),p.uc("hidden",t.IsWebApp))},directives:[a.V,a.G,a.t,a.bb,a.W,a.n,a.E,r.i,a.x,a.u,a.N,a.I,a.jb,s.h,a.D],styles:["ion-menu[_ngcontent-%COMP%]{--max-width:200px}"]}),d);n.d(t,"MenuPageModule",(function(){return b}));var v,y=[{path:"",component:m,children:[{path:"paipan",loadChildren:"../paipan/paipan.module#PaipanPageModule"},{path:"recordes/:id",loadChildren:"../recordes/recordes.module#RecordesPageModule"},{path:"nodes",loadChildren:"../nodes/nodes.module#NodesPageModule"},{path:"forum",loadChildren:"../../forum/forum/forum.module#ForumPageModule"},{path:"topiclist/:forumid",loadChildren:"../../forum/topiclist/topiclist.module#TopiclistPageModule"},{path:"topicdetail/:forumid/:topicid",loadChildren:"../../forum/topicviewer/topicviewer.module#TopicviewerPageModule"},{path:"topicpanfu/:arg",loadChildren:"../../forum/panfuviewer/panfuviewer.module#PanfuviewerPageModule"},{path:"messagelist/:naviback",loadChildren:"../../forum/messagelist/messagelist.module#MessagelistPageModule"},{path:"user",loadChildren:"../../user/userprofil/userprofil.module#UserprofilPageModule"},{path:"searchuser",loadChildren:"../../user/searchuser/searchuser.module#SearchuserPageModule"},{path:"setting",loadChildren:"../setting/setting.module#SettingPageModule"},{path:"recordview/:nodeid/:recid",loadChildren:"../recordviewer/recordviewer.module#RecordviewerPageModule"},{path:"compass",loadChildren:"../compass/compass.module#CompassPageModule"}]}],b=((v=function e(){_classCallCheck(this,e)}).\u0275mod=p.Xb({type:v}),v.\u0275inj=p.Wb({factory:function(e){return new(e||v)},imports:[[r.b,i.c,a.cb,s.i.forChild(y)]]}),v)},"0eVs":function(e,t){},"2QJI":function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return d}));var r=n("ZtG1"),i=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.index=t,this.name=n}return _createClass(e,[{key:"Ref",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!e.HuahePianCai;n&&(r=!n);var i=this.Index%2==t.Index%2,s=this.WuXing,a=t.WuXing;return s.Ke===a.Index?i?["\u4e03\u6740","\u6740"]:["\u6b63\u5b98","\u5b98"]:s.Sheng===a.Index?i?["\u67ad\u795e","\u67ad"]:["\u6b63\u5370","\u5370"]:a.Ke===s.Index?i!==r?["\u6b63\u8d22","\u8d22"]:["\u504f\u8d22","\u624d"]:a.Sheng===s.Index?i?["\u98df\u795e","\u98df"]:["\u4f24\u5b98","\u4f24"]:i?["\u6bd4\u80a9","\u6bd4"]:["\u52ab\u8d22","\u52ab"]}},{key:"GetChangSheng",value:function(t){var n=e.Shuitugongchangsheng;t&&(n=t);var r=n?e.changshengIndexes_shuitu:e.changshengIndexes;return this.Index%2==0?r[Math.floor(this.Index/2)]:(r[Math.floor((this.Index-1)/2)]+7)%12}},{key:"Name",get:function(){return this.name}},{key:"Index",get:function(){return this.index}},{key:"WuXing",get:function(){var e=Math.floor(this.Index/2);return e=(e+2)%5,Object(r.a)(e)}},{key:"ChangSheng",get:function(){return this.GetChangSheng(null)}},{key:"QiYueGan",get:function(){var e=this.Index%5*2;return e=(e+2)%10}},{key:"QiShiGan",get:function(){return this.Index%5*2}}]),e}();return e.changshengIndexes=[11,2,2,5,8],e.changshengIndexes_shuitu=[11,2,8,5,8],e.Shuitugongchangsheng=!1,e.HuahePianCai=!1,e}(),s=new Array;function a(){10!==s.length&&(s.push(new i(0,"\u7532")),s.push(new i(1,"\u4e59")),s.push(new i(2,"\u4e19")),s.push(new i(3,"\u4e01")),s.push(new i(4,"\u620a")),s.push(new i(5,"\u5df1")),s.push(new i(6,"\u5e9a")),s.push(new i(7,"\u8f9b")),s.push(new i(8,"\u58ec")),s.push(new i(9,"\u7678")))}var o=function(){var e=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.index=t,this.name=n,this.gans=r,this.gans2=i,i||(this.gans2=this.gans)}return _createClass(e,[{key:"ChangSheng",value:function(e){return this.GetChangSheng(e,void 0)}},{key:"Ref",value:function(e){var t=this.Index%2==e.Index%2,n=this.WuXing,r=e.WuXing;return n.Ke===r.Index?t?["\u4e03\u6740","\u6740"]:["\u6b63\u5b98","\u5b98"]:n.Sheng===r.Index?t?["\u6b63\u5370","\u5370"]:["\u67ad\u795e","\u67ad"]:r.Ke===n.Index?t?["\u6b63\u8d22","\u8d22"]:["\u504f\u8d22","\u624d"]:r.Sheng===n.Index?t?["\u4f24\u5b98","\u4f24"]:["\u98df\u795e","\u98df"]:t?["\u6bd4\u80a9","\u6bd4"]:["\u52ab\u8d22","\u52ab"]}},{key:"GetChangSheng",value:function(t,n){for(var r=t.GetChangSheng(n),i=t.Index%2==0?1:-1,s=0;s<12;s++)if((r+s*i+12)%12===this.Index)return e.changShengDefs[s];return"Error"}},{key:"Name",get:function(){return this.name}},{key:"Index",get:function(){return this.index}},{key:"WuXing",get:function(){switch(this.Index){case 2:case 3:return Object(r.a)("\u6728");case 5:case 6:return Object(r.a)("\u706b");case 8:case 9:return Object(r.a)("\u91d1");case 0:case 11:return Object(r.a)("\u6c34");default:return Object(r.a)("\u571f")}}},{key:"CGan",get:function(){var e=new Array,t=i.HuahePianCai?this.gans:this.gans2,n=!0,r=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;e.push(f(u))}}catch(c){r=!0,s=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return e}}]),e}();return e.changShengDefs=["\u957f\u751f","\u6c90\u6d74","\u51a0\u5e26","\u4e34\u5b98","\u5e1d\u65fa","\u8870","\u75c5","\u6b7b","\u5893","\u7edd","\u80ce","\u517b"],e}(),u=new Array;function c(){12!==u.length&&(u.push(new o(0,"\u5b50",[9])),u.push(new o(1,"\u4e11",[9,7,5])),u.push(new o(2,"\u5bc5",[0,2,5],[0,2,4])),u.push(new o(3,"\u536f",[1])),u.push(new o(4,"\u8fb0",[1,4,9])),u.push(new o(5,"\u5df3",[2,4,6])),u.push(new o(6,"\u5348",[3],[3,5])),u.push(new o(7,"\u672a",[1,3,5])),u.push(new o(8,"\u7533",[5,6,8])),u.push(new o(9,"\u9149",[7])),u.push(new o(10,"\u620c",[3,4,7])),u.push(new o(11,"\u4ea5",[0,4,8],[0,8])))}var h=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"ChangSheng",get:function(){return i.Shuitugongchangsheng},set:function(e){i.Shuitugongchangsheng=e||!1}},{key:"Huahe",get:function(){return i.HuahePianCai},set:function(e){i.HuahePianCai=e||!1}}]),e}();function f(e){if(a(),"string"==typeof e){var t=s.filter((function(t){return t.Name===e}));if(1===t.length)return t[0]}else if("number"==typeof e&&e>=0&&e<=9)return s[e];throw new Error("Parameter Error of Gan: "+e+" is not valiad")}function l(){return a(),s.map((function(e){return e.Name}))}function p(e){if(c(),"string"==typeof e){"\u620d"===e&&(e="\u620c");var t=u.filter((function(t){return t.Name===e}));if(1===t.length)return t[0]}else if("number"==typeof e&&e>=0&&e<=11)return u[e];throw new Error("Parameter Error of Gan: "+e+" is not valiad")}function g(){return c(),u.map((function(e){return e.Name}))}var d=function(){var e=function(){function e(t){if(_classCallCheck(this,e),Array.isArray(t)&&2===t.length)this.Gan=f(t[0]),this.Zhi=p(t[1]);else if("string"==typeof t)this.Gan=2===t.length?f(t.substring(0,1)):null,this.Zhi=p(2===t.length?t.substring(1,2):t.substring(0,1));else if("number"==typeof t&&t>=0&&t<=59){var n=t%12;this.Gan=f(t%10),this.Zhi=p(n)}if(this.Config(i.Shuitugongchangsheng,i.HuahePianCai),null==this.Zhi||void 0===this.Zhi)throw new Error("GanZhi Error: parameter "+t+" is not valid.")}return _createClass(e,[{key:"Config",value:function(e,t){this.shuitu=e||!1,this.huahe=t||!1}},{key:"calcIndex",value:function(e,t){var n=(t-e+12)%12/2;return(n=(6-n)%6*10)+e}},{key:"Name",get:function(){return this.Gan?this.Gan.Name+this.Zhi.Name:this.Zhi.Name}},{key:"Index",get:function(){return this.Gan?this.calcIndex(this.Gan.Index,this.Zhi.Index):this.Zhi.Index}},{key:"NaYin",get:function(){return null==this.Gan?"":e.NaYins[Math.floor(this.Index/2)]}},{key:"Shen10Gan",get:function(){if(!this.Base)throw new Error("BaseGan is not defined.");return this===this.Base?["\u65e5\u4e3b","\u65e5"]:this.Gan.Ref(this.Base.Gan,this.huahe)}},{key:"Shen10Zhi",get:function(){if(!this.Base)throw new Error("BaseGan is not defined.");return this.Zhi.Ref(this.Base.Gan)}},{key:"ChangSheng",get:function(){return this.Base?this.Zhi.GetChangSheng(this.Base.Gan,this.shuitu):""}}],[{key:"GanZhiNames",get:function(){for(var e=l(),t=g(),n=new Array,r=0;r<e.length;r++)for(var i=0;i<t.length;i++)r%2==i%2&&n.push(e[r]+t[i]);return n}}]),e}();return e.NaYins=["\u6d77\u4e2d\u91d1","\u7089\u4e2d\u706b","\u5927\u6797\u6728","\u8def\u65c1\u571f","\u5251\u5cf0\u91d1","\u5c71\u5934\u706b","\u6da7\u4e0b\u6c34","\u57ce\u5899\u571f","\u767d\u8721\u91d1","\u6768\u67f3\u6728","\u6cc9\u4e2d\u6c34","\u5c4b\u4e0a\u571f","\u9739\u96f3\u706b","\u677e\u67cf\u6728","\u957f\u6d41\u6c34","\u6c99\u4e2d\u91d1","\u5c71\u4e0b\u706b","\u5e73\u5730\u6728","\u58c1\u4e0a\u571f","\u91d1\u7b94\u91d1","\u4f5b\u706f\u706b","\u5929\u6cb3\u6c34","\u5927\u9a7f\u571f","\u9497\u948f\u91d1","\u6851\u677e\u6728","\u5927\u6eaa\u6c34","\u6c99\u4e2d\u571f","\u5929\u4e0a\u706b","\u77f3\u69b4\u6728","\u5927\u6d77\u6c34"],e}()},LTmD:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return f}));var r=n("FAH8"),i=n("c7TG"),s=(n("0eVs"),n("2QJI")),a=n("2Vo4"),o=n("fXoL"),u=n("e8h1"),c=function(){var e=function(){function e(t,n,r){var i=this;_classCallCheck(this,e),this.storage=t,this.file=n,this.plateform=r,this.user=null,this.lastsync=0,this.encryp="false",this.dbReady=new a.a(!1),this.dbReady.next(!1),this.ReadSettingFromDB().then((function(e){console.log("Device width",r.width(),r.height())})).finally((function(){i.dbReady.next(!0)}))}return _createClass(e,[{key:"Avatar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"female"===(e||"")?"assets/img/user_female.png":"assets/img/user_male.png"}},{key:"UserRolers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[];return(1&(e=e||0))>0&&t.push({name:"\u6ce8\u518c\u7528\u6237",icon:"assets/img/roles/r_register.png",value:1}),(2&e)>0&&t.push({name:"VIP",icon:"assets/img/roles/r_vip.png",value:2}),(4&e)>0&&t.push({name:"\u534e\u9e64\u540c\u95e8",icon:"assets/img/huahe.jpg",value:4}),(8&e)>0&&t.push({name:"\u7248\u4e3b",icon:"assets/img/roles/r_admin.png",value:8}),(16&e)>0&&t.push({name:"\u516d\u723b",icon:"assets/img/roles/r_master.png",value:16}),(64&e)>0&&t.push({name:"\u98ce\u6c34",icon:"assets/img/roles/r_master.png",value:64}),(32&e)>0&&t.push({name:"\u547d\u7406",icon:"assets/img/roles/r_master.png",value:32}),(128&e)>0&&t.push({name:"\u5927\u5b97\u5e08",icon:"assets/img/roles/r_supermaster.png",value:128}),(256&e)>0&&t.push({name:"\u7ba1\u7406\u5458",icon:"assets/img/roles/r_admin.png",value:256}),t}},{key:"WaitInit",value:function(){var e=this;return new Promise((function(t,n){e.InitState.subscribe((function(e){e&&t(!0)}))}))}},{key:"ReadSettingFromDB",value:function(){var t=this,n=this.storage.get(e.APP_CONFIG).then((function(e){t.appconfig=e})).catch((function(e){return e})),r=this.storage.get(e.DB_GUA).then((function(e){t.Gua=e,t.gua.symbol=t.gua.symbol||0})).catch((function(e){return e})),i=this.storage.get(e.DB_BAZI).then((function(e){t.Bazi=e})).catch((function(e){return e})),s=this.storage.get(e.DB_USER).then((function(e){t.user=e||{id:null,created:null,modified:null,lastlogin:null,name:null,password:null,email:null,phone:null,vip:null,roller:null,verified:null}})).catch((function(e){return e})),a=this.storage.get(e.DB_LASTSYNC).then((function(e){t.lastsync=e})).catch((function(e){return e})),o=this.storage.get(e.USER_ENCRYP).then((function(e){t.encryp=e||t.encryp})).catch((function(e){return e})),u=this.storage.get(e.FORUM_SET).then((function(e){t.forum=e})).catch((function(e){return e}));return Promise.all([n,r,i,s,a,o,u]).then((function(e){return e}))}},{key:"ResetDB",value:function(){return this.storage.clear()}},{key:"ShowData",value:function(e){"*"!==e?this.storage.get(e).then((function(t){if(t){var n=function(e){try{return"string"==typeof e?JSON.parse(e):e}catch(t){return null}}(t)||t;console.log("Show ".concat(e),n)}else console.log("Show ".concat(e),t)})).catch((function(t){console.log("Show ".concat(e," failed"),t)})):this.storage.keys().then((function(e){console.log(e)}))}},{key:"IsDevice",get:function(){return this.plateform.is("mobile")&&!this.plateform.is("mobileweb")}},{key:"IsSmallScreen",get:function(){return this.plateform.width()<400||this.plateform.isPortrait()}},{key:"DeviceHeight",get:function(){return this.plateform.height()}},{key:"DeviceWidth",get:function(){return this.plateform.width()}},{key:"InitState",get:function(){return this.dbReady.asObservable()}},{key:"AppConfig",get:function(){return this.appconfig||e.default_appconfig},set:function(t){this.appconfig=t,this.storage.set(e.APP_CONFIG,this.appconfig)}},{key:"Encryp",get:function(){return"true"===this.encryp.toLowerCase()},set:function(t){this.encryp=t?"true":"false",this.storage.set(e.USER_ENCRYP,this.encryp)}},{key:"Gua",get:function(){return this.gua||e.defalt_gua_setting},set:function(t){this.gua=t||e.defalt_gua_setting,this.storage.set(e.DB_GUA,this.gua)}},{key:"Bazi",get:function(){return this.bazi||e.default_bazi_setting},set:function(t){this.bazi=t||e.default_bazi_setting,s.a.ChangSheng=this.bazi.shuitu,s.a.Huahe=this.bazi.huahecai,this.storage.set(e.DB_BAZI,this.bazi)}},{key:"HasUser",get:function(){return!!this.User&&!!this.User.id&&""!==this.User.id}},{key:"User",get:function(){return this.user},set:function(t){this.user=t,t?this.storage.set(e.DB_USER,this.user):(this.user=null,this.storage.remove(e.DB_USER))}},{key:"LastSync",get:function(){return this.lastsync},set:function(t){this.lastsync=t,this.storage.set(e.DB_LASTSYNC,t)}}]),e}();return e.SAVELOCAL="local",e.SAVEBLOBAL="global",e.GUASYMBOLS=[["\u25fc\ufe0e\u25fb\ufe0e\u25fc\ufe0e","\u25fc\ufe0e\u25fc\ufe0e\u25fc\ufe0e","\u25fc\ufe0e&ensp;\u25fc\ufe0e"],["=","-","="]],e.Product=!1,e.DB_BAZI="bazi_setting",e.DB_GUA="gua_setting",e.DB_USER="userinfo",e.DB_LASTSYNC="lastsync",e.APP_CONFIG="appconfig",e.USER_ENCRYP="encryp",e.FORUM_SET="forum_setting",e.defalt_gua_setting={fontsize:15,shensha:4,shortname:!1,symbol:0},e.default_bazi_setting={fontsize:15,shortname:!0,shuitu:!0,shensha:4,huahecai:!0,yuanju:{cangan:!0,nayin:!0,changshen:!0},shiyun:{cangan:!1,nayin:!1,changshen:!1,shensha:!1}},e.default_forum_setting={showimg:!0,showgua:!1,showbazi:!1,imgOut:!1,guaOut:!1,baziOut:!0},e.default_appconfig={app:{version:"2.0.1",accessToken:"as%3aRdE87!08jR\xf6",serverUrl:"https://1051463780297201.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/huaheservice/sqlquery"},website:"https://maiernte.gitee.io/huahe",document:"https://maiernte.gitee.io/huahedocument"},e.\u0275fac=function(t){return new(t||e)(o.ic(u.b),o.ic(r.a),o.ic(i.hb))},e.\u0275prov=o.Vb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function h(e,t){var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++){var s=n[i];if("object"!=typeof e[s]){if(e[s]!==t[s])return!1}else if(!1===h(e[s],t[s]))return!1}return!0}function f(e){if(!e)return e;var t;if([Number,String,Boolean].forEach((function(n){e instanceof n&&(t=n(e))})),void 0===t)if("[object Array]"===Object.prototype.toString.call(e))t=[],e.forEach((function(e,n,r){t[n]=f(e)}));else if("object"==typeof e)if(e.nodeType&&"function"==typeof e.cloneNode)t=e.cloneNode(!0);else if(e.prototype)t=e;else if(e instanceof Date)t=new Date(e);else for(var n in t={},e)t[n]=f(e[n]);else t=e;return t}},PKx9:function(e,t,n){"use strict";var r=n("mrSG"),i=n("LTmD"),s=n("lEof");n("aGhr");var a=function(){function e(){_classCallCheck(this,e),this.topics=[]}return _createClass(e,[{key:"Reset",value:function(){this.topics=[]}},{key:"GetPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.topics.find((function(n){return n.forumid===e&&t===n.page}));return n?{data:n.items,sum:n.sum}:null}},{key:"SetPage",value:function(e,t,n,r){var i=this.topics.find((function(n){return n.forumid===e&&t===n.page}));i?i.items=n:this.topics.push({forumid:e,page:t,items:n,sum:r})}},{key:"GetTopic",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,s=this.topics[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value.items.find((function(t){return t.id===e}));if(a)return a}}catch(o){n=!0,r=o}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}return null}},{key:"SetTopic",value:function(e,t){var n=this.GetPage(t,0);n?n.data.insert(0,e):this.SetPage(t,0,[e],1)}},{key:"DeleteTopic",value:function(e,t){if(t);else{var n=!0,r=!1,i=void 0;try{for(var s,a=this.topics[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var o=s.value;o.items.find((function(t){return t.id===e}))&&(o.items=o.items.filter((function(t){return t.id!==e})))}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}},{key:"UpdateTopic",value:function(e){var t=this.GetTopic(e.id);if(t)for(var n in e)t[n]=e[n]}}]),e}(),o=n("Y6BA"),u=(n("0eVs"),n("fXoL"));n.d(t,"a",(function(){return h}));var c,h=((c=function(){function e(t,n){_classCallCheck(this,e),this.settings=t,this.host=n,this.vusers=[],this.currentTopics=[],this.ForumMG=new a}return _createClass(e,[{key:"ForumList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.ForumMG.Forumlist||!1!==e){t.next=4;break}t.t0=Promise.resolve(this.ForumMG.Forumlist),t.next=7;break;case 4:return t.next=6,this.settings.WaitInit();case 6:t.t0=this.LoadForumList();case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"LoadTopicList",value:function(e,t,n){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,s,a,o,u=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e||"forum_"+n,i=-2===n?e+"good":i,s=-1===n?n:t,!(a=this.ForumMG.GetPage(i,s))){r.next=5;break}return r.abrupt("return",Promise.resolve(a));case 5:return o={func:"TopicList",forumid:e,params:{filter:{},startColumn:20*t,private:!1}},r.abrupt("return",(-1===n?o.params.filter.top=1:-2===n?o.params.filter.good=!0:-3===n?(o.params.filter.author=this.User.id,o.params.filter.topic=null):-4===n?(o.params.filter.author=this.User.id,o.params.filter.topic=null,o.params.private=!0):-5===n?(o.params.filter.forumid=this.User.id,o.params.filter.topic=null,o.params.private=!0):o.params.filter.top=0,e&&(o.params.filter.forumid=e),this.host.ForumRequest(this.User.id,this.User.password,o).then((function(e){return e&&e.data&&u.ForumMG.SetPage(i,s,e.data,e.sum),e})).catch((function(e){return Promise.reject(e)}))));case 7:case"end":return r.stop()}}),r,this)})))}},{key:"LoadAnswerList",value:function(e,t,n){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"TopicList",forumid:t,params:{filter:{topic:e},sort:"created",startColumn:20*n,direction:1}}).then((function(e){return e})).catch((function(e){return Promise.reject(e)})));case 1:case"end":return r.stop()}}),r,this)})))}},{key:"NewTopic",value:function(e,t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"NewTopic",forumid:e,params:t}).then((function(e){return e})).catch((function(e){return Promise.reject(e)})));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"GetTopic",value:function(e,t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=this.ForumMG.GetTopic(t),n.abrupt("return",i?Promise.resolve(i):this.host.ForumRequest(this.User.id,this.User.password,{func:"GetTopic",forumid:e||"",params:{topicid:t||"",private:!1}}).then((function(e){return Object(r.b)(s,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:return n=t.sent,t.next=5,this.GetUserInfo(n.author);case 5:return r=t.sent,i=(r||o.a).avatar||"",t.abrupt("return",(n.avatar=i.IsNullOrEmpty()?this.settings.Avatar(r.gender):i,n.showImg=!0,n.showGua=!0,n.showBazi=!0,e));case 8:case"end":return t.stop()}}),t,this)})))})).catch((function(e){return Promise.reject(e)})));case 2:case"end":return n.stop()}}),n,this)})))}},{key:"UpdatForum",value:function(e,t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"UpdateForum",params:{id:t,data:e}}).then((function(e){return e})).catch((function(e){return console.log("updat failed",e),Promise.reject(e)})));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"UpdateTopic",value:function(e,t,n){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"Update",params:{id:t,private:n,data:e}}).then((function(e){return e})).catch((function(e){return console.log("updat failed",e),Promise.reject(e)})));case 1:case"end":return r.stop()}}),r,this)})))}},{key:"GetUserInfo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=this.VUsers.find((function(t){return t.id===e}));return r?Promise.resolve(r):this.host.ForumRequest(this.User.id,this.User.password,{func:"GetVUser",author:e,roller:n}).then((function(e){return t.VUsers.push(e),e})).catch((function(e){return Promise.reject(e)}))}},{key:"DeleteTopic",value:function(e,t){var n=this;return this.host.ForumRequest(this.User.id,this.User.password,{func:"DeleteTopic",params:{topicid:e}}).then((function(r){return n.ForumMG.DeleteTopic(e,t),r})).catch((function(e){return Promise.reject(e)}))}},{key:"SendMessage",value:function(e){return this.host.ForumRequest(this.User.id,this.User.password,{func:"SendMessage",params:{message:e}}).then((function(e){return e})).catch((function(e){return Promise.reject(e)}))}},{key:"LoadMessages",value:function(e,t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"MessageList",params:{pageindex:e,forme:t}}).then((function(e){return e})).catch((function(e){return Promise.reject(e)})));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"DeleteMessage",value:function(e,t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"DeleteMessage",params:{msgid:e,todelete:t}}).then((function(e){return e})).catch((function(e){return Promise.reject(e)})));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"HoldPublicMessage",value:function(){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initial();case 2:return e.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"HoldPublicMsg"}).then((function(e){return e})).catch((function(e){return Promise.reject(e)})));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"UpgradUser",value:function(e,t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.initial();case 2:return n.abrupt("return",this.host.ForumRequest(this.User.id,this.User.password,{func:"UpgradeUser",params:{id:e,data:t}}).then((function(e){return e})).catch((function(e){return Promise.reject(e)})));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"initial",value:function(){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.User,e.t0){e.next=4;break}return e.next=4,this.settings.WaitInit();case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"LoadForumList",value:function(){var e=this;return this.host.ForumRequest(this.User.id,this.User.password,{func:"ForumList"}).then((function(t){return e.ForumMG.Forumlist=t,t})).catch((function(e){return Promise.reject(e)}))}},{key:"User",get:function(){return this.settings.User||o.a}},{key:"VUsers",get:function(){return this.vusers=this.vusers||[],this.vusers=this.vusers.filter((function(e){return!!e}))||[],this.vusers},set:function(e){this.vusers=e||[]}}]),e}()).\u0275fac=function(e){return new(e||c)(u.ic(i.a),u.ic(s.a))},c.\u0275prov=u.Vb({token:c,factory:c.\u0275fac,providedIn:"root"}),c)},Y6BA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),String.prototype.int2str=function(e,t){var n=this.toString(null==t||void 0===t?2:t);if(n.length>=e)return n;for(;n.length<e;)n="0"+n;return n},String.prototype.parseDate=function(){var e=this.replace(/[\u5e74\u6708\u65e5\u65f6\u5206\u79d2:\uff1a,\uff0c\ \/-]/g,"|").split("|").removeEmpty().select((function(e){return parseInt(e,10)}));return new Date(e[0],e[1]-1,e[2],e[3]||0,e[4]||0,e[5]||0)},String.prototype.IsNullOrEmpty=function(){return void 0===this||null==this||""===this},Array.prototype.select=function(e){var t=[];return this.forEach((function(n){t.push(e(n))})),t},Array.prototype.where=function(e){var t=[];return this.forEach((function(n){e(n)&&t.push(n)})),t},Array.prototype.distinct=function(){for(var e={},t=[],n=0,r=this.length;n<r;++n)e.hasOwnProperty(this[n])||(t.push(this[n]),e[this[n]]=1);return t},Array.prototype.insert=function(e,t){this.splice(e,0,t)},Array.prototype.removeEmpty=function(){return this.filter((function(e){return!!e&&""!==(e||"").toString()}))},Array.prototype.sortByKey=function(e){return this.sort((function(t,n){var r=t[e]||0,i=n[e]||0;return r<i?-1:r>i?1:0}))},Date.prototype.toChinaStr=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getFullYear()+"\u5e74"+(this.getMonth()+1)+"\u6708"+this.getDate()+"\u65e5";return!0===e&&(t+=" "+this.getHours().toString().int2str(2,10)+"\u65f6",t+=this.getMinutes().toString().int2str(2,10)+"\u5206",t+=this.getSeconds().toString().int2str(2,10)+"\u79d2"),t},Date.prototype.toDatabaseStr=function(){var e=this.getFullYear()+"-"+(this.getMonth()+1).toString().int2str(2,10)+"-"+this.getDate().toString().int2str(2,10);return e+=" "+this.getHours().toString().int2str(2,10)+":",e+=this.getMinutes().toString().int2str(2,10)+":",e+=this.getSeconds().toString().int2str(2,10)};var r={id:"anonym",created:0,modified:0,lastlogin:0,name:null,password:"",email:null,phone:null,vip:0,verified:0,encryp:"null",roller:0,avatar:"assets/img/user_male.png"};function i(e,t,n){return n.indexOf(e)===t}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return e&&"number"==typeof e?t.substring(0,e):t}},ZtG1:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=function(){function e(t,n){_classCallCheck(this,e),this.name=t,this.index=n}return _createClass(e,[{key:"Ref",value:function(e){return this.Ke==e.Index?["\u5b98\u9b3c","\u5b98"]:this.Sheng==e.Index?["\u7236\u6bcd","\u7236"]:e.Ke==this.index?["\u59bb\u8d22","\u8d22"]:e.Sheng==this.index?["\u5b50\u5b59","\u5b59"]:["\u5144\u5f1f","\u5144"]}},{key:"Name",get:function(){return this.name}},{key:"Index",get:function(){return this.index}},{key:"Ke",get:function(){return(this.index+2)%5}},{key:"Sheng",get:function(){return(this.index+1)%5}}]),e}(),i=[];function s(e){if("number"==typeof e){if(e>=0&&e<=4)return i[e];throw new RangeError("WuXing index out of range: "+e)}var t=i.filter((function(t){return t.Name==e}));if(t&&1==t.length)return t[0];throw new RangeError("WuXing name out of range: "+e)}i.push(new r("\u91d1",0)),i.push(new r("\u6c34",1)),i.push(new r("\u6728",2)),i.push(new r("\u706b",3)),i.push(new r("\u571f",4))},aGhr:function(e,t){}}]);