function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{L99X:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("mrSG"),r=n("c7TG"),s=n("LTmD"),o=n("2Vo4"),a=n("Y6BA"),u=(n("xPBH"),n("fXoL")),c=n("e8h1"),h=n("tk/3"),d=function(){var e=function(){function e(t,n,i,r){var s=this;_classCallCheck(this,e),this.settings=t,this.plateform=n,this.storage=i,this.http=r,this.dbReady=new o.a(!1),this.LoadBooks().then((function(e){if(s.nodes=e||[],0===s.Nodes.length)return s.CreateNode(void 0,"\u4e34\u65f6\u6848\u4f8b",32)})).finally((function(){s.dbReady.next(!0)}))}return _createClass(e,[{key:"ReloadBooks",value:function(){var e=this;this.dbReady.next(!1),this.LoadBooks().then((function(t){e.nodes=t||[]})).finally((function(){e.dbReady.next(!0)}))}},{key:"GetAllNodes",value:function(){var e=this;return new Promise((function(t,n){e.DatabaseState.subscribe((function(n){n&&t(e.Nodes)}))}))}},{key:"SaveNodes",value:function(){var t=this,n=this.settings.HasUser?"".concat(e.DB_NODES,"_").concat(this.settings.User.id):e.DB_NODES;return new Promise((function(e,i){var r=JSON.stringify(t.nodes);t.storage.set(n,r).then((function(t){e(!0)})).catch((function(e){i(!1)}))}))}},{key:"CreateNode",value:function(e,t,n){var i=this;return new Promise((function(r,s){var o={id:Object(a.createGuid)(8),created:0,modified:0,parent:e,name:t||"\u4e34\u65f6\u6848\u4f8b",comment:"",type:n||1,size:0,sync:0};i.nodes=i.nodes||[],i.nodes.push(o),i.SaveNodes().then((function(e){r(i.Nodes)})).catch((function(e){s(e)}))}))}},{key:"ChangeNode",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(r,s){var o=n.nodes.where((function(t){return t.id===e}));if(o&&1===o.length){var a=o[0];a.name=t||a.name,a.parent=i||a.parent,n.SaveNodes().then((function(e){r(n.Nodes)})).catch((function(e){s(!1)}))}}))}},{key:"DeleteNodes",value:function(e){var t=this,n=Date.now();return new Promise((function(i,r){var s=[];t.nodes.forEach((function(t){e.includes(t.id)&&(t.size=-1,t.modified=n,32===t.type&&s.push(t.id))})),t.SaveNodes().then((function(e){i(t.Nodes)})).catch((function(e){r(!1)}))}))}},{key:"SyncNodes",value:function(e){var t=this,n=this.nodes.map((function(e){return e.id})),i=[],r=[];return e.forEach((function(e){if(n.includes(e.id)){if(t.nodes.find((function(t){return t.id===e.id})).modified<e.modified){var r=t.nodes.findIndex((function(t){return t.id===e.id}));t.nodes.splice(r,1,Object(s.b)(e)),i.push(e.id)}}else t.nodes.push(Object(s.b)(e)),i.push(e.id)})),this.CleanNodes(),this.nodes.forEach((function(t){var n=e.find((function(e){return e.id===t.id}));t.name.startsWith("\u516d\u723b")&&console.log("...",n,t),(!n||n.modified<t.modified)&&r.push(t.id)})),i.length>0?(console.log("new Booktree will be saved.",this.nodes),this.SaveNodes().then((function(){return[i,r]}))):Promise.resolve([i,r])}},{key:"CleanNodes",value:function(){var e=Date.now()-2592e6;this.nodes=this.nodes.filter((function(t){return t.size<0&&t.modified<e||t.size>=0}))}},{key:"GetRecordes",value:function(e){var t=this;return new Promise((function(n,i){t.storage.get("Book_".concat(e)).then((function(r){if(r){var s=JSON.parse(r);n(s.filter((function(e){return e.size>=0})))}else 0===t.Nodes.find((function(t){return t.id===e})).sync?(t.SaveRecordes(e,[]),n([])):i([])})).catch((function(e){i(e)}))}))}},{key:"SaveRecordes",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console.log("save recordes of ",e);var i=JSON.stringify(t);if(this.storage.set("Book_".concat(e),i),n){var r=this.nodes.find((function(t){return t.id===e}));r.created=0===r.created?Date.now():r.created,r.modified=Date.now(),r.size=i.length,this.SaveNodes()}}},{key:"CreateRecord",value:function(e,t,n,i){return{id:Object(a.createGuid)(8),node:e,created:Date.now(),modified:Date.now(),type:n,titel:t,arg:i,content:"",size:0,sync:0}}},{key:"SaveRecord",value:function(e,t,n,i){var r=this;return new Promise((function(s,o){r.storage.get("Book_".concat(e)).then((function(o){var a=JSON.parse(o),u=r.CreateRecord(e,t,n,i);a.push(u),r.SaveRecordes(e,a),s(u)}))}))}},{key:"DeleteRecordes",value:function(e,t){var n=this;return new Promise((function(i,r){n.storage.get("Book_".concat(e)).then((function(r){var s=JSON.parse(r);s.forEach((function(e){t.includes(e.id)&&(e.size=-1,e.content="",e.arg="",e.modified=Date.now())})),n.SaveRecordes(e,s),i(s.filter((function(e){return e.size>=0})))}))}))}},{key:"MoveRecordes",value:function(e,t,n){var i=this;return new Promise((function(r,s){var o=i.storage.get("Book_".concat(e)).then((function(e){return JSON.parse(e)||[]})),a=i.storage.get("Book_".concat(t)).then((function(e){return JSON.parse(e)||[]}));Promise.all([o,a]).then((function(s){var o=s[0],a=s[1],u=!0,c=!1,h=void 0;try{for(var d,l=function(){var e=d.value,n=o.find((function(t){return t.id===e}));n.node=t,a.push(n),o=o.filter((function(t){return t.id!==e}))},f=n[Symbol.iterator]();!(u=(d=f.next()).done);u=!0)l()}catch(b){c=!0,h=b}finally{try{u||null==f.return||f.return()}finally{if(c)throw h}}console.log("move finish",o,a,n),i.SaveRecordes(e,o),i.SaveRecordes(t,a),r(o.filter((function(e){return e.size>=0})))}))}))}},{key:"ChangeBooktreeOfAnonym",value:function(t){var n=this,i="".concat(e.DB_NODES,"_").concat(t);return this.storage.keys().then((function(t){return t.includes(i)?Promise.reject("".concat(i," is already hier.")):n.storage.get(e.DB_NODES)})).then((function(e){return e?(console.log("umschreiben booktree to ",i),n.storage.set("".concat(i),e)):Promise.reject("booktree can not founde.")})).then((function(){return console.log("umschreiben erfolg!"),n.storage.remove(e.DB_NODES)})).then((function(){return console.log("Record ".concat(e.DB_NODES," will deleted")),!0})).catch((function(e){return console.log("ChangeBooktreeOfAnonym denied: ",e),!1}))}},{key:"test",value:function(e){var t=this;return this.storage.get("...").then((function(n){return console.log("get ...",n),t.storage.get(e)})).then((function(t){return console.log("get ".concat(e),t),Promise.resolve(!0)}))}},{key:"WaitInit",value:function(){var e=this;return new Promise((function(t,n){e.DatabaseState.subscribe((function(e){e&&t(!0)}))}))}},{key:"LoadBooks",value:function(){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.settings.WaitInit();case 2:return n=this.settings.HasUser?"".concat(e.DB_NODES,"_").concat(this.settings.User.id):e.DB_NODES,t.abrupt("return",(console.log("loadbooks of ".concat(n)),this.storage.get(n).then((function(e){return Promise.resolve(Object(s.d)(e))})).catch((function(e){return console.error("LoadBooks() error:",e),Promise.resolve([])}))));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"DatabaseState",get:function(){return this.dbReady.asObservable()}},{key:"Nodes",get:function(){return this.nodes.filter((function(e){return e.size>=0}))}},{key:"NodesAlle",get:function(){return this.nodes}},{key:"NodeModified",get:function(){return Math.max.apply(Math,_toConsumableArray(this.nodes.map((function(e){return e.modified}))))}}]),e}();return e.DB_NODES="booktree",e.\u0275fac=function(t){return new(t||e)(u.dc(s.a),u.dc(r.Y),u.dc(c.b),u.dc(h.b))},e.\u0275prov=u.Sb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},lotG:function(e,t,n){"use strict";n.r(t);var i,r,s=n("ofXK"),o=n("3Pt+"),a=n("tyNb"),u=n("c7TG"),c=n("mrSG"),h=n("L99X"),d=n("LTmD"),l=n("gTpY"),f=n("ylIl"),b=(n("0eVs"),n("fXoL")),g=((r=function(){function e(t){_classCallCheck(this,e),this.modalCtrl=t}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onSave",value:function(){this.modalCtrl.dismiss(this.Content)}},{key:"onCancel",value:function(){this.modalCtrl.dismiss("cancel")}},{key:"onDelete",value:function(){this.modalCtrl.dismiss("delete")}}]),e}()).\u0275fac=function(e){return new(e||r)(b.Wb(u.W))},r.\u0275cmp=b.Qb({type:r,selectors:[["app-recordcontenteditor"]],inputs:{Content:"Content"},decls:24,vars:3,consts:[["color","secondary"],["slot","start"],[3,"click"],["name","close-circle"],["slot","end"],["name","save"],["scrollY","true"],["position","stacked"],["slot","end","fill","clear","color","danger",3,"hidden","click"],["name","trash"],["auto-grow","true",2,"background-color","cornsilkd",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(b.Zb(0,"ion-header"),b.Zb(1,"ion-toolbar",0),b.Zb(2,"ion-buttons",1),b.Zb(3,"ion-button",2),b.hc("click",(function(e){return t.onCancel()})),b.Xb(4,"ion-icon",3),b.Zb(5,"ion-text"),b.xc(6,"\u53d6\u6d88"),b.Yb(),b.Yb(),b.Yb(),b.Zb(7,"ion-title"),b.xc(8),b.Yb(),b.Zb(9,"ion-buttons",4),b.Zb(10,"ion-button",2),b.hc("click",(function(e){return t.onSave()})),b.Xb(11,"ion-icon",5),b.Zb(12,"ion-text"),b.xc(13,"\u4fdd\u5b58"),b.Yb(),b.Yb(),b.Yb(),b.Yb(),b.Yb(),b.Zb(14,"ion-content",6),b.Zb(15,"ion-item"),b.Zb(16,"ion-label",7),b.xc(17,"\u7f16\u8f91\u5185\u5bb9"),b.Yb(),b.Zb(18,"ion-button",8),b.hc("click",(function(e){return t.onDelete()})),b.Xb(19,"ion-icon",9),b.Zb(20,"ion-label"),b.xc(21,"\u5220\u9664"),b.Yb(),b.Yb(),b.Yb(),b.Zb(22,"ion-item"),b.Zb(23,"ion-textarea",10),b.hc("ngModelChange",(function(e){return t.Content.text=e})),b.Yb(),b.Yb(),b.Yb()),2&e&&(b.Mb(8),b.yc(t.Content.type),b.Mb(10),b.oc("hidden",0===t.Content.time),b.Mb(5),b.oc("ngModel",t.Content.text))},directives:[u.p,u.T,u.i,u.h,u.q,u.O,u.R,u.l,u.t,u.u,u.P,u.cb,o.c,o.d],styles:[""]}),r),v=((i=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){return new Date(e).toChinaStr(t)}}]),e}()).\u0275fac=function(e){return new(e||i)},i.\u0275pipe=b.Vb({name:"chinadate",type:i,pure:!0}),i);function y(e,t){if(1&e&&b.Xb(0,"app-guaview",19),2&e){var n=b.jc();b.oc("Config",n.Config)("GuaText",n.Gua)}}function p(e,t){if(1&e&&b.Xb(0,"app-baziview",20),2&e){var n=b.jc();b.oc("Config",n.Config)("BaziText",n.Bazi)}}function m(e,t){if(1&e){var n=b.ac();b.Zb(0,"ion-item",21),b.hc("click",(function(e){b.rc(n);var i=t.$implicit;return b.jc().EditContent(i)})),b.Zb(1,"ion-note",22),b.xc(2),b.Yb(),b.Zb(3,"ion-label",23),b.Zb(4,"pre"),b.xc(5),b.Yb(),b.Zb(6,"p"),b.Zb(7,"small"),b.xc(8),b.kc(9,"chinadate"),b.Yb(),b.Yb(),b.Yb(),b.Yb()}if(2&e){var i=t.$implicit;b.Mb(2),b.yc(i.type),b.Mb(3),b.yc(i.text),b.Mb(3),b.yc(b.lc(9,3,i.time,!0))}}var k,x=((k=function(){function e(t,n,i,r,s){var o=this;_classCallCheck(this,e),this.route=t,this.dbservice=n,this.setting=i,this.alertCtrl=r,this.modalCtrl=s,this.EditModul=!1,this.index=0,this.smallSymbol=!1,this.HiddenCode=!1,this.HiddenTitel="",this.route.params.subscribe((function(e){o.nodeid=e.nodeid,o.recid=e.recid}))}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setting.WaitInit();case 2:return this.guaconfig=Object(d.b)(this.setting.Gua),this.baziconfig=Object(d.b)(this.setting.Bazi),this.content=[],e.next=7,this.dbservice.WaitInit();case 7:this.dbservice.GetRecordes(this.nodeid).then((function(e){t.recordes=e,t.updateRecord()})),this.dbservice.GetAllNodes().then((function(e){var n=e.find((function(e){return e.id===t.nodeid}));t.nodename=n.name}));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"ShowHideCode",value:function(){this.HiddenCode=!this.HiddenCode,!0===this.HiddenCode&&(this.guaview?this.HiddenTitel="".concat(this.guaview.GuaInText," \u95ee: ").concat(this.Record.titel):this.baziview&&(this.HiddenTitel="".concat(this.Record.titel,"(").concat(this.baziview.Gender,"): ").concat(this.baziview.BaziInText)))}},{key:"NextRecord",value:function(e){this.index=this.index+e,this.recid=this.recordes[this.Index].id,this.updateRecord()}},{key:"AddContent",value:function(e){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.EditContent({type:e,time:0,text:""});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"EditContent",value:function(e){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:g,componentProps:{Content:Object(d.b)(e)}});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.next=7,n.onWillDismiss();case 7:if(i=t.sent,"delete"!==(r=i.data)){t.next=13;break}this.content=this.content.filter((function(t){return t!==e})),t.next=16;break;case 13:if("cancel"!==r){t.next=15;break}return t.abrupt("return");case 15:0===r.time?(r.time=Date.now(),this.content.push(r)):(e.time=Date.now(),e.text=r.text);case 16:console.log("save change"),this.Record.content=JSON.stringify(this.content),this.dbservice.SaveRecordes(this.Record.node,this.recordes);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"ChangSymbol",value:function(){!1===this.smallSymbol?(this.guaconfig.shensha=4,this.guaconfig.symbol=1,this.baziconfig.shensha=4):(this.guaconfig=Object(d.b)(this.setting.Gua),this.baziconfig=Object(d.b)(this.setting.Bazi)),this.smallSymbol=!this.smallSymbol,this.guaview&&this.guaview.Reflash(this.guaconfig),this.baziview&&this.baziview.Reflash(this.baziconfig)}},{key:"EidtTitel",value:function(){return Object(c.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,this.alertCtrl.create({header:"\u95ee\u5ff5\uff0f\u540d\u5b57",message:"Message <strong>text</strong>!!!",inputs:[{name:"titel",type:"text",id:"titel-id",value:this.Record.titel}],buttons:[{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary"},{text:"\u786e\u5b9a",handler:function(){t=!0}}]});case 3:return n=e.sent,e.next=6,n.present();case 6:return e.next=8,n.onWillDismiss();case 8:i=e.sent,r=i.data,t&&(s=r.values.titel,this.Record.titel=s,this.guaview?(this.gua.question=s,this.Record.arg=JSON.stringify(this.gua),this.guaview.Titel="\u95ee\u5ff5\uff1a"+s):this.baziview&&(this.bazi.person=s,this.Record.arg=JSON.stringify(this.bazi),this.baziview.Person="".concat(s," (").concat(this.baziview.Gender,"\u9020)")),this.dbservice.SaveRecordes(this.Record.node,this.recordes));case 11:case"end":return e.stop()}}),e,this)})))}},{key:"updateRecord",value:function(){var e=this.Record;8===e.type?(this.gua=JSON.parse(e.arg),this.bazi=null):16===e.type&&(this.bazi=JSON.parse(e.arg),this.gua=null),this.content=JSON.parse(e.content||"[]")}},{key:"Config",get:function(){return this.HasGua?this.guaconfig:this.HasBazi?this.baziconfig:null}},{key:"NodeName",get:function(){return this.nodename||"\u6848\u4f8b"}},{key:"Record",get:function(){var e=this;if(this.recordes){var t=this.recordes.find((function(t){return t.id===e.recid}));return this.index=this.recordes.indexOf(t),t}return null}},{key:"Gua",get:function(){return this.gua}},{key:"Bazi",get:function(){return this.bazi}},{key:"HasGua",get:function(){return!!this.Gua}},{key:"HasBazi",get:function(){return!!this.Bazi}},{key:"Index",get:function(){return this.index}},{key:"Length",get:function(){return(this.recordes||[]).length}},{key:"Content",get:function(){return this.content||[]}}]),e}()).\u0275fac=function(e){return new(e||k)(b.Wb(a.a),b.Wb(h.a),b.Wb(d.a),b.Wb(u.b),b.Wb(u.W))},k.\u0275cmp=b.Qb({type:k,selectors:[["app-recordviewer"]],viewQuery:function(e,t){var n;1&e&&(b.Ac(l.a,!0),b.Ac(f.a,!0)),2&e&&(b.qc(n=b.ic())&&(t.baziview=n.first),b.qc(n=b.ic())&&(t.guaview=n.first))},decls:44,vars:11,consts:[["slot","start",3,"hidden"],["defaulthref","","text","\u8fd4\u56de"],["slot","end"],[3,"click"],["name","md-options"],["name","md-code-working"],["position","fixed","margin-horizontal","0",3,"hidden"],[3,"Config","GuaText",4,"ngIf"],[3,"hidden"],[1,"ion-padding"],[3,"Config","BaziText",4,"ngIf"],["lines","inset","detail","",3,"click",4,"ngFor","ngForOf"],["size","small","slot","start","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-back"],["size","small",3,"click"],["name","add"],["name","md-clipboard"],["size","small","slot","end","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-forward"],[3,"Config","GuaText"],[3,"Config","BaziText"],["lines","inset","detail","",3,"click"],["slot","start"],[1,"ion-text-wrap"]],template:function(e,t){1&e&&(b.Zb(0,"ion-header"),b.Zb(1,"ion-toolbar"),b.Zb(2,"ion-buttons",0),b.Xb(3,"ion-back-button",1),b.Yb(),b.Zb(4,"ion-title"),b.xc(5),b.Yb(),b.Zb(6,"ion-buttons",2),b.Zb(7,"ion-button",3),b.hc("click",(function(e){return t.ChangSymbol()})),b.Xb(8,"ion-icon",4),b.Yb(),b.Zb(9,"ion-button",3),b.hc("click",(function(e){return t.ShowHideCode()})),b.Xb(10,"ion-icon",5),b.Yb(),b.Yb(),b.Yb(),b.Yb(),b.Zb(11,"div",6),b.wc(12,y,1,2,"app-guaview",7),b.Yb(),b.Zb(13,"ion-item",8),b.Zb(14,"ion-label"),b.xc(15),b.Yb(),b.Yb(),b.Zb(16,"ion-content",9),b.Zb(17,"div",8),b.wc(18,p,1,2,"app-baziview",10),b.Yb(),b.Zb(19,"ion-list"),b.wc(20,m,10,6,"ion-item",11),b.Yb(),b.Yb(),b.Zb(21,"ion-footer"),b.Zb(22,"ion-toolbar"),b.Zb(23,"ion-button",12),b.hc("click",(function(e){return t.NextRecord(-1)})),b.Xb(24,"ion-icon",13),b.Yb(),b.Zb(25,"ion-buttons"),b.Zb(26,"ion-button",14),b.hc("click",(function(e){return t.AddContent("\u80cc\u666f")})),b.Xb(27,"ion-icon",15),b.Zb(28,"ion-text"),b.xc(29,"\u80cc\u666f"),b.Yb(),b.Yb(),b.Zb(30,"ion-button",14),b.hc("click",(function(e){return t.AddContent("\u53cd\u9988")})),b.Xb(31,"ion-icon",15),b.Zb(32,"ion-text"),b.xc(33,"\u53cd\u9988"),b.Yb(),b.Yb(),b.Zb(34,"ion-button",14),b.hc("click",(function(e){return t.AddContent("\u89e3\u8bfb")})),b.Xb(35,"ion-icon",15),b.Zb(36,"ion-text"),b.xc(37,"\u89e3\u8bfb"),b.Yb(),b.Yb(),b.Zb(38,"ion-button",14),b.hc("click",(function(e){return t.EidtTitel()})),b.Xb(39,"ion-icon",16),b.Zb(40,"ion-text"),b.xc(41,"\u95ee\u5ff5"),b.Yb(),b.Yb(),b.Yb(),b.Zb(42,"ion-button",17),b.hc("click",(function(e){return t.NextRecord(1)})),b.Xb(43,"ion-icon",18),b.Yb(),b.Yb(),b.Yb()),2&e&&(b.Mb(2),b.oc("hidden",t.EditModul),b.Mb(3),b.yc(t.NodeName),b.Mb(6),b.oc("hidden",t.HiddenCode),b.Mb(1),b.oc("ngIf",t.HasGua),b.Mb(1),b.oc("hidden",!t.HiddenCode),b.Mb(2),b.yc(t.HiddenTitel),b.Mb(2),b.oc("hidden",t.HiddenCode),b.Mb(1),b.oc("ngIf",t.HasBazi),b.Mb(2),b.oc("ngForOf",t.Content),b.Mb(3),b.oc("disabled",0===t.Index),b.Mb(19),b.oc("disabled",t.Index===t.Length-1))},directives:[u.p,u.T,u.i,u.f,u.g,u.R,u.h,u.q,u.d,s.j,u.t,u.u,u.l,u.v,s.i,u.n,u.O,f.a,l.a,u.A],pipes:[v],styles:[""]}),k),w=n("uEAi"),S=n("n7QD");n.d(t,"RecordviewerPageModule",(function(){return N}));var C,I=[{path:"",component:x}],N=((C=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ub({type:C}),C.\u0275inj=b.Tb({factory:function(e){return new(e||C)},imports:[[w.a,S.a,s.b,o.a,u.U,a.i.forChild(I)]]}),C)},pNW8:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}));var i=n("l+bK"),r=n("2QJI"),s=n("uq+3"),o=n("ZtG1");n("Y6BA");var a=function(){function e(t,n,i,r,s,o){_classCallCheck(this,e),this.index=t,this.name=n,this.namev=i,this.wuxing=r,this.zhis=s,this.nagan=o,this.value=function(e,t,n){var i=e.toString(2);if(i.length>=3)return i;for(;i.length<3;)i="0"+i;return i}(t)}return _createClass(e,[{key:"GanZhi",value:function(e){return new r.b((e=(e+6)%6)<3?[this.NaGan[0],this.Zhis[e]]:[this.NaGan[1],this.Zhis[e]])}},{key:"Index",get:function(){return this.index}},{key:"Name",get:function(){return this.name}},{key:"NameV",get:function(){return this.namev}},{key:"Value",get:function(){return this.value}},{key:"WuXing",get:function(){return this.wuxing}},{key:"Zhis",get:function(){return this.zhis}},{key:"NaGan",get:function(){return this.nagan}}]),e}(),u=new Array,c=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.shang=u[t],this.xia=u[n]}return _createClass(e,[{key:"ZhiIndex",value:function(e){return this.GanZhis[(e+6)%6].Index}},{key:"Shang",get:function(){return this.shang}},{key:"Xia",get:function(){return this.xia}},{key:"Index",get:function(){return 8*this.Shang.Index+this.Xia.Index}},{key:"NameS",get:function(){return e.GuaNames[this.Index]}},{key:"Name",get:function(){return this.Shang===this.Xia?this.Shang.Name+"\u4e3a"+this.Shang.NameV:this.Shang.NameV+this.Xia.NameV+this.NameS}},{key:"Mean",get:function(){var t=this;return e.GuaChiJie.filter((function(e){return e.indexOf(t.Name)>=0}))[0]}},{key:"GuaGong",get:function(){return u[this.GuaGongI].Name+"\u5bab"}},{key:"GuaGongI",get:function(){return e.CalcGuaGong(this.Shang.Index,this.Xia.Index).GuaGong}},{key:"Shiyao",get:function(){return e.CalcGuaGong(this.Shang.Index,this.Xia.Index).ShiWei}},{key:"Property",get:function(){var e=this.Xia.Zhis[0],t=this.Shang.Zhis[3],n="";e+t==13||e+t==1?n+="\u516d\u5408":6==Math.abs(e-t)&&(n+="\u516d\u51b2");var i=parseInt(this.Shang.Value,2)^parseInt(this.Xia.Value,2);return 5==i?n+="\u6e38\u9b42":2==i&&(n+="\u5f52\u9b42"),n}},{key:"GanZhis",get:function(){if(!this.ganzhis){this.ganzhis=new Array;var e=this.Xia.NaGan[0],t=!0,n=!1,i=void 0;try{for(var s,o=this.Xia.Zhis.slice(0,3)[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var a=s.value,u=new r.b([e,a]);this.ganzhis.push(u)}}catch(v){n=!0,i=v}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}e=this.Shang.NaGan[1];var c=!0,h=!1,d=void 0;try{for(var l,f=this.Shang.Zhis.slice(3,6)[Symbol.iterator]();!(c=(l=f.next()).done);c=!0){var b=l.value,g=new r.b([e,b]);this.ganzhis.push(g)}}catch(v){h=!0,d=v}finally{try{c||null==f.return||f.return()}finally{if(h)throw d}}}return this.ganzhis}},{key:"WuXing",get:function(){var e=u[this.GuaGongI];return Object(o.a)(e.wuxing)}}],[{key:"CalcGuaGong",value:function(e,t){var n=-1,i=-1;switch(e^t){case 7:n=2,i=e;break;case 6:case 5:n=3,i=7^t;break;case 4:n=4,i=7^t;break;case 3:n=1,i=e;break;case 2:n=2,i=t;break;case 1:n=0,i=e;break;case 0:n=5,i=e}return{GuaGong:i%=8,ShiWei:n}}}]),e}();return e.GuaChiJie=["\u4e7e\u4e3a\u5929\uff1a\u5f3a\u5065\u3001\u542f\u59cb","\u5929\u98ce\u59e4\uff1a\u758f\u6f0f\u3001\u76f8\u9047","\u5929\u5c71\u9041\uff1a\u9003\u9041\u3001\u9690\u9000","\u5c71\u5730\u5265\uff1a\u5265\u843d\u3001\u663e\u9732","\u706b\u5730\u664b\uff1a\u664b\u5347\u3001\u524d\u8fdb","\u706b\u5929\u5927\u6709\uff1a\u6536\u83b7\u3001\u4e30\u5bcc","\u98ce\u5730\u89c2\uff1a\u8003\u5bdf\u3001\u89c2\u671b","\u574e\u4e3a\u6c34\uff1a\u574e\u51f9\u3001\u9677\u5165","\u5dfd\u4e3a\u98ce\uff1a\u8ddf\u98ce\u3001\u4e0a\u884c\u4e0b\u6548","\u6c34\u6cfd\u8282\uff1a\u8282\u5ea6\u3001\u5236\u7ea6","\u6c34\u96f7\u5c6f\uff1a\u5c6f\u79ef\u3001\u521d\u59cb","\u6c34\u706b\u65e2\u6d4e\uff1a\u987a\u5176\u81ea\u7136\u3001\u987a\u7545","\u6cfd\u706b\u9769\uff1a\u6539\u53d8\u3001\u9769\u65b0","\u96f7\u706b\u4e30\uff1a\u4e30\u5bcc\u3001\u5f20\u626c","\u5730\u6c34\u5e08\uff1a\u5355\u4e00\u3001\u7387\u4f17","\u826e\u4e3a\u5c71\uff1a\u5806\u79ef\u3001\u53d7\u963b","\u5c71\u706b\u8d32\uff1a\u7c89\u9970\u3001\u793c\u4eea","\u5730\u706b\u660e\u5937\uff1a\u524d\u6709\u9669\u3001\u52a8\u5219\u4f24","\u5c71\u6cfd\u635f\uff1a\u635f\u5931\u3001\u53d7\u635f","\u706b\u6cfd\u777d\uff1a\u53cd\u76ee\u3001\u80cc\u9a70","\u96f7\u5c71\u5c0f\u8fc7\uff1a\u8fc7\u706b\uff0c\u53ef\u8865\u6551\u8fc7\u5931","\u5929\u6cfd\u5c65\uff1a\u5c65\u884c\u3001\u6301\u793c","\u98ce\u5c71\u6e10\uff1a\u6e10\u8fd1\u3001\u7f13\u8fd1","\u98ce\u6cfd\u4e2d\u5b5a\uff1a\u575a\u6301\u3001\u8bda\u4fe1","\u9707\u4e3a\u96f7\uff1a\u7a81\u53d1\u3001\u8d70\u52a8","\u96f7\u6c34\u89e3\uff1a\u89e3\u51b3\u3001\u91ca\u653e","\u706b\u98ce\u9f0e\uff1a\u72ec\u5f53\u4e00\u9762\u3001\u6781\u81f4","\u5730\u98ce\u5347\uff1a\u8fdb\u5c55\u3001\u63d0\u5347","\u6c34\u98ce\u4e95\uff1a\u89c4\u5212\u3001\u5c40\u675f","\u96f7\u6cfd\u5f52\u59b9\uff1a\u5982\u613f\u3001\u56de\u62a5","\u6cfd\u96f7\u968f\uff1a\u8ddf\u968f\u3001\u5f52\u987a","\u5929\u5730\u5426\uff1a\u53d7\u963b\u3001\u95ed\u585e","\u6cfd\u98ce\u5927\u8fc7\uff1a\u592a\u8fc7\u5206\u3001\u5df2\u906d\u635f\u5931","\u98ce\u96f7\u76ca\uff1a\u6709\u76ca\u3001\u53d7\u76ca","\u5c71\u96f7\u9890\uff1a\u9890\u8868\u3001\u57f9\u517b","\u98ce\u5929\u5c0f\u755c\uff1a\u6d45\u79ef\u7d2f\uff0c\u6b20\u5145\u5206","\u5c71\u98ce\u86ca\uff1a\u53d1\u52a8\u3001\u8c0b\u4e8b","\u79bb\u4e3a\u706b\uff1a\u5916\u9732\u3001\u7eda\u4e3d","\u5c71\u6c34\u8499\uff1a\u542f\u8499\u3001\u4e0d\u6e05\u6670","\u706b\u5c71\u65c5\uff1a\u65c5\u884c\u3001\u5ba2\u5c45","\u98ce\u6c34\u6da3\uff1a\u6da3\u6563\u3001\u53d1\u6563","\u98ce\u706b\u5bb6\u4eba\uff1a\u4eb2\u4eba\u3001\u5f52\u5bb6\u3001\u56de\u6536","\u5929\u6c34\u8bbc\uff1a\u8c08\u5224\u3001\u8bc9\u8bbc","\u5764\u4e3a\u5730\uff1a\u5305\u542b\u3001\u627f\u8f7d","\u5929\u96f7\u65e0\u5984\uff1a\u65e0\u5984\u4e3a\u3001\u65e0\u8fc7\u5931","\u5730\u96f7\u590d\uff1a\u53cd\u590d\u3001\u91cd\u590d","\u96f7\u98ce\u6052\uff1a\u6052\u4e45\u3001\u4e0d\u53d8","\u706b\u96f7\u566c\u55d1\uff1a\u6c9f\u901a\uff0c\u6709\u76ee\u7684\u4ea4\u6d41","\u5730\u6cfd\u4e34\uff1a\u4e34\u8fd1\u3001\u964d\u4e34","\u5730\u5929\u6cf0\uff1a\u901a\u6cf0\u3001\u901a\u7545","\u6cfd\u5929\u592c\uff1a\u7f3a\u9677\u3001\u4e0d\u5b8c\u6574","\u6c34\u5929\u9700\uff1a\u7b49\u5f85\u3001\u7b79\u5907","\u6c34\u5730\u6bd4\uff1a\u4eb2\u5bc6\u3001\u5e73\u7b49","\u706b\u6c34\u672a\u6d4e\uff1a\u963b\u788d\u3001\u672a\u8fbe\u76ee\u7684","\u5151\u4e3a\u6cfd\uff1a\u8c08\u8bdd\u3001\u6109\u60a6","\u6cfd\u6c34\u56f0\uff1a\u53d7\u56f0\u3001\u88ab\u56f4","\u5929\u706b\u540c\u4eba\uff1a\u968f\u5927\u6d41\u3001\u4e0e\u4f17\u540c\u7b49","\u6cfd\u5730\u8403\uff1a\u7a81\u51fa\u3001\u805a\u96c6 ","\u6cfd\u5c71\u54b8\uff1a\u53c2\u4e0e\u3001\u904d\u5e03","\u96f7\u5929\u5927\u58ee\uff1a\u4f17\u6240\u5468\u77e5\u3001\u6b63\u5f53\u5176\u7528","\u6c34\u5c71\u8e47\uff1a\u884c\u9669\u3001\u96be\u5173","\u96f7\u5730\u8c6b\uff1a\u6b22\u6109\u3001\u72b9\u8c6b","\u5730\u5c71\u8c26\uff1a\u8c26\u900a\u3001\u6df1\u85cf\u4e0d\u9732","\u5c71\u5929\u5927\u755c\uff1a\u79ef\u755c\u5df2\u4e45\u3001\u51c6\u5907\u5145\u5206"],e.GuaNames=["\u5730","\u590d","\u5e08","\u4e34","\u8c26","\u660e\u5937","\u5347","\u6cf0","\u8c6b","\u96f7","\u89e3","\u5f52\u59b9","\u5c0f\u8fc7","\u4e30","\u6052","\u5927\u58ee","\u6bd4","\u5c6f","\u6c34","\u8282","\u8e47","\u65e2\u6d4e","\u4e95","\u9700","\u8403","\u968f","\u56f0","\u6cfd","\u54b8","\u9769","\u5927\u8fc7","\u592c","\u5265","\u9890","\u8499","\u635f","\u5c71","\u8d32","\u86ca","\u5927\u755c","\u664b","\u566c\u55d1","\u672a\u6d4e","\u777d","\u65c5","\u706b","\u9f0e","\u5927\u6709","\u89c2","\u76ca","\u6da3","\u4e2d\u5b5a","\u6e10","\u5bb6\u4eba","\u98ce","\u5c0f\u755c","\u5426","\u65e0\u5984","\u8bbc","\u5c65","\u9041","\u540c\u4eba","\u59e4","\u5929"],e}(),h=new Array;function d(){if(64!==h.length){8!==u.length&&(u.push(new a(0,"\u5764","\u5730",4,[7,5,3,1,11,9],[1,9])),u.push(new a(1,"\u9707","\u96f7",2,[0,2,4,6,8,10],[6,6])),u.push(new a(2,"\u574e","\u6c34",1,[2,4,6,8,10,0],[4,4])),u.push(new a(3,"\u5151","\u6cfd",0,[5,3,1,11,9,7],[3,3])),u.push(new a(4,"\u826e","\u5c71",4,[4,6,8,10,0,2],[2,2])),u.push(new a(5,"\u79bb","\u706b",3,[3,1,11,9,7,5],[5,5])),u.push(new a(6,"\u5dfd","\u98ce",2,[1,11,9,7,5,3],[7,7])),u.push(new a(7,"\u4e7e","\u5929",0,[0,2,4,6,8,10],[0,8])));for(var e=0;e<8;e++)for(var t=0;t<8;t++)h.push(new c(e,t))}}var l=["\u9752\u9f99","\u6731\u96c0","\u52fe\u9648","\u87a3\u86c7","\u767d\u864e","\u7384\u6b66"];function f(e){d();var t=isNaN(e.toString())?-1:parseInt(e.toString()),n="string"==typeof e?e:void 0;if("number"==typeof t&&t>=0&&t<64)return h[t];if(n){n=n.length>=3?n.substr(2):n;var i=c.GuaNames.indexOf(n);if(i>=0)return h[i]}if((n=e.toString()).match(/[\u5730\u96f7\u6c34\u6cfd\u5c71\u706b\u98ce\u5929]{2}/)){var r="\u5730\u96f7\u6c34\u6cfd\u5c71\u706b\u98ce\u5929".indexOf(n.substr(0,1)),s="\u5730\u96f7\u6c34\u6cfd\u5c71\u706b\u98ce\u5929".indexOf(n.substr(1,1));return h[8*r+s]}throw new Error("\u516d\u5341\u56db\u5366\u7684\u5366\u540d\u6216\u8005\u5e8f\u5217\u53f7\u51fa\u9519: ".concat(e.toString(),", ").concat(typeof e))}var b=function(){function e(t,n,s){_classCallCheck(this,e),d();var o="string"==typeof t?t.parseDate():void 0,a=Array.isArray(t)?t:void 0;if(o){var u=new Date(o.getTime()+36e5),c=new i.a(u);this.guatime=[new r.b(c.GZmonth),new r.b(c.GZdate)]}else{var h=new r.b(a[0]),l=new r.b(a[1]);this.guatime=[h,l]}s||(s=n),n=n.replace(" ",""),s=s.replace(" ","");var b=n.split("\u4e4b");2==b.length&&(n=b[0],s=b[1]),this.bengua=f(n),this.biangua=f(s);var g=this.bengua.GuaGongI;this.fugua=f(8*g+g),this.initShenSha(),this.initShen6()}return _createClass(e,[{key:"GetLineZhi",value:function(e){var t=this.FuGua.GanZhis.map((function(e){return e.Index})).join()!=this.Ben.GanZhis.map((function(e){return e.Index})).join(),n=this.Ben.Index!=this.Bian.Index,i=new Array;return t&&i.push(this.FuGua.GanZhis[e-1].Zhi.Index==this.Ben.GanZhis[e-1].Zhi.Index?"":this.FuGua.GanZhis[e-1].Zhi.Index.toString()),i.push(this.Ben.GanZhis[e-1].Zhi.Index.toString()),n&&i.push(this.Bian.GanZhis[e-1].Zhi.Index.toString()),i}},{key:"GetLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.FuGua.GanZhis.map((function(e){return e.Index})).join()!=this.Ben.GanZhis.map((function(e){return e.Index})).join(),i=this.Ben.Index!=this.Bian.Index,r=this.Ben.WuXing,s=new Array;if(s.push(t?this.shen6[e-1].substring(1):this.shen6[e-1]),n)if(this.FuGua.GanZhis[e-1].Zhi.Index==this.Ben.GanZhis[e-1].Zhi.Index)s.push("");else{var o=this.FuGua.GanZhis[e-1].Zhi,a=t?o.WuXing.Ref(r)[1]+o.Name:o.WuXing.Ref(r)[0]+o.Name+o.WuXing.Name;s.push(a)}s.push(this.Benyaos[e-1]);var u=this.Ben.GanZhis[e-1].Zhi,c=t?u.WuXing.Ref(r)[1]+u.Name:u.WuXing.Ref(r)[0]+u.Name+u.WuXing.Name;if(s.push(c),s.push(this.Ben.Shiyao==e-1?"\u4e16":(this.Ben.Shiyao+3)%6==e-1?"\u5e94":""),i){s.push(this.Benyaos[e-1]>1?">":"");var h=this.Bian.GanZhis[e-1].Zhi;s.push(this.Bianyaos[e-1]);var d=t?h.WuXing.Ref(r)[1]+h.Name:h.WuXing.Ref(r)[0]+h.Name+h.WuXing.Name;s.push(d)}return s}},{key:"equal",value:function(e){return this.Yue.Index==e.Yue.Index&&this.Ri.Index==e.Ri.Index&&this.Ben.Index==e.Ben.Index&&this.Bian.Index==e.Bian.Index}},{key:"initShenSha",value:function(){this.shenshas=[],this.shenshas.push(new s.a("\u5c06\u661f",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u534e\u76d6",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u9a7f\u9a6c",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u8c0b\u661f",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u6843\u82b1",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u707e\u715e",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u52ab\u715e",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u7984\u795e",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u7f8a\u5203",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u6587\u660c",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u5929\u559c",[this.guatime[0].Index])),this.shenshas.push(new s.a("\u5929\u533b",[this.guatime[0].Index])),this.shenshas.push(new s.a("\u8d35\u4eba",[this.guatime[1].Index])),this.shenshas.push(new s.a("\u65ec\u7a7a",[this.guatime[1].Index]))}},{key:"initShen6",value:function(){this.shen6=[];var e=this.guatime[1].Gan.Index;e=e>=5?Math.floor((e+2)/2):Math.floor(e/2);for(var t=0;t<6;t++)this.shen6.push(l[(e+t)%6].substring(0,2))}},{key:"Yue",get:function(){return this.guatime[0]}},{key:"Ri",get:function(){return this.guatime[1]}},{key:"ShenShas",get:function(){return this.shenshas}},{key:"Ben",get:function(){return this.bengua}},{key:"Bian",get:function(){return this.biangua}},{key:"FuGua",get:function(){return this.fugua}},{key:"Shen6",get:function(){return this.shen6}},{key:"Benyaos",get:function(){for(var e=(this.Ben.Shang.Value+this.Ben.Xia.Value).split(""),t=[],n=5;n>=0;n--)t.push(parseInt(e[n]));for(var i=this.Bianyaos,r=5;r>=0;r--)t[r]!=i[r]&&(t[r]+=2);return t}},{key:"Bianyaos",get:function(){for(var e=(this.Bian.Shang.Value+this.Bian.Xia.Value).split(""),t=[],n=5;n>=0;n--)t.push(parseInt(e[n]));return t}}]),e}()},xPBH:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(t,n){arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.Type=t,this.Title=n,this.ShowButton=!0,this.isExpanded=!1,this.isSelected=!1,this.url="",this.sub=[]}return _createClass(e,[{key:"SubNodesId",value:function(e){e.push(this.ID);var t=!0,n=!1,i=void 0;try{for(var r,s=this.Sub[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){r.value.SubNodesId(e)}}catch(o){n=!0,i=o}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}}},{key:"IsFile",get:function(){return 32===this.Type}},{key:"IsSelected",get:function(){return this.isSelected},set:function(e){this.isSelected=e}},{key:"IsExpanded",get:function(){return this.isExpanded},set:function(e){0!==this.Sub.length&&(this.isExpanded=e)}},{key:"Icon",get:function(){switch(this.Type){case 2:return"person";case 4:return"lock";case 8:return"menu";case 16:return"walk";case 32:return"document";case 1:default:return"folder"}}},{key:"Url",get:function(){return this.url}},{key:"Sub",get:function(){return this.sub},set:function(e){this.sub=e}},{key:"Color",get:function(){return this.isSelected?"tertiary":""}},{key:"ColorB",get:function(){return this.isSelected?"light":""}}],[{key:"getNodePath",value:function(e,t){var n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=e?e.Sub:r;if((t||"").IsNullOrEmpty())return["\u6839\u76ee\u5f55"];if((null===(n=e)||void 0===n?void 0:n.ID)===t)return[e.Title];if(!(s.length>0))return null;var o=!0,a=!1,u=void 0;try{for(var c,h=s[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var d=c.value,l=this.getNodePath(d,t);if(l)return l.insert(0,(null===(i=e)||void 0===i?void 0:i.Title)||""),l}}catch(f){a=!0,u=f}finally{try{o||null==h.return||h.return()}finally{if(a)throw u}}}},{key:"Examples",get:function(){var t=[],n=new e(1,"Folder 01"),i=new e(2,"Folder 02"),r=new e(4,"Folder 03"),s=new e(32,"file 01",!0),o=new e(8,"file 02",!0),a=new e(16,"file 03",!0),u=new e(8,"file 04",!0),c=new e(32,"file 05",!0),h=new e(16,"file 06",!0);return n.Sub.push(i),i.Sub.push(s),i.Sub.push(o),i.Sub.push(a),r.Sub.push(u),r.Sub.push(c),r.Sub.push(h),t.push(n),t.push(r),t}}]),e}()}}]);