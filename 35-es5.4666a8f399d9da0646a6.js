function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{lotG:function(e,t,n){"use strict";n.r(t);var i,c,o=n("ofXK"),r=n("3Pt+"),a=n("tyNb"),s=n("c7TG"),d=n("mrSG"),u=n("LTmD"),l=n("gTpY"),f=n("ylIl"),h=n("HULg"),b=n("+z1p"),p=(n("0eVs"),n("fXoL")),v=n("zioG"),m=((i=function(){function e(t,n){_classCallCheck(this,e),this.modalCtrl=t,this.alertController=n,this.Editor=b,this.EditorConfig={toolbar:["heading","|","bold","italic","bulletedList","numberedList","|","link","undo","redo"]}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onSave",value:function(){this.modalCtrl.dismiss(this.Content)}},{key:"onCancel",value:function(){this.modalCtrl.dismiss("cancel")}},{key:"onDelete",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.presentConfirm("\u5220\u9664\u5185\u5bb9",null,"\u786e\u5b9a\u5220\u9664\u6b64\u5185\u5bb9\u5417\uff1f");case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.modalCtrl.dismiss("delete");case 5:case"end":return e.stop()}}),e,this)})))}},{key:"onEditorReady",value:function(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement())}},{key:"presentConfirm",value:function(e,t,n){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=!1,i.next=3,this.alertController.create({header:e||"\u63d0\u793a",subHeader:t||"",message:n,buttons:[{text:"\u786e\u5b9a",handler:function(){c=!0}},{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary",handler:function(){}}]});case 3:return o=i.sent,i.next=6,o.present();case 6:return i.next=8,o.onWillDismiss();case 8:return i.abrupt("return",Promise.resolve(c));case 9:case"end":return i.stop()}}),i,this)})))}}]),e}()).\u0275fac=function(e){return new(e||i)(p.Zb(s.cb),p.Zb(s.b))},i.\u0275cmp=p.Tb({type:i,selectors:[["app-recordcontenteditor"]],inputs:{Content:"Content"},decls:20,vars:5,consts:[["color","secondary"],["slot","start"],["color","danger",3,"hidden","click"],["name","trash"],["slot","end"],[3,"click"],["name","close-circle"],["name","save"],["scrollY","true"],[3,"ngModel","config","editor","ngModelChange","ready"]],template:function(e,t){1&e&&(p.ec(0,"ion-header"),p.ec(1,"ion-toolbar",0),p.ec(2,"ion-buttons",1),p.ec(3,"ion-button",2),p.mc("click",(function(){return t.onDelete()})),p.ac(4,"ion-icon",3),p.ec(5,"ion-label"),p.Ic(6,"\u5220\u9664"),p.dc(),p.dc(),p.dc(),p.ec(7,"ion-title"),p.Ic(8),p.dc(),p.ec(9,"ion-buttons",4),p.ec(10,"ion-button",5),p.mc("click",(function(){return t.onCancel()})),p.ac(11,"ion-icon",6),p.ec(12,"ion-text"),p.Ic(13,"\u53d6\u6d88"),p.dc(),p.dc(),p.ec(14,"ion-button",5),p.mc("click",(function(){return t.onSave()})),p.ac(15,"ion-icon",7),p.ec(16,"ion-text"),p.Ic(17,"\u4fdd\u5b58"),p.dc(),p.dc(),p.dc(),p.dc(),p.dc(),p.ec(18,"ion-content",8),p.ec(19,"ckeditor",9),p.mc("ngModelChange",(function(e){return t.Content.text=e}))("ready",(function(e){return t.onEditorReady(e)})),p.dc(),p.dc()),2&e&&(p.Nb(3),p.vc("hidden",0===t.Content.time),p.Nb(5),p.Kc("\u7f16\u8f91\uff1a",t.Content.type,""),p.Nb(11),p.vc("ngModel",t.Content.text)("config",t.EditorConfig)("editor",t.Editor))},directives:[s.t,s.Y,s.j,s.i,s.u,s.D,s.W,s.T,s.n,v.a,r.f,r.g],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[contenteditable][_ngcontent-%COMP%], ckeditor[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}[_nghost-%COMP%]     .ck-editor__editable_inline{min-height:200px}"]}),i),g=n("Y6BA"),C=n("i/bi"),x=((c=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){return new Date(e).toChinaStr(t)}}]),e}()).\u0275fac=function(e){return new(e||c)},c.\u0275pipe=p.Yb({name:"chinadate",type:c,pure:!0}),c);function k(e,t){if(1&e){var n=p.fc();p.ec(0,"ion-header"),p.ec(1,"ion-toolbar"),p.ec(2,"ion-buttons",7),p.ac(3,"ion-back-button",8),p.dc(),p.ec(4,"ion-title"),p.Ic(5),p.dc(),p.ec(6,"ion-buttons",9),p.ec(7,"ion-button",10),p.mc("click",(function(){p.Bc(n);var e=p.pc();return e.HiddenCode=!e.HiddenCode})),p.ac(8,"ion-icon",11),p.dc(),p.dc(),p.dc(),p.dc()}if(2&e){var i=p.pc();p.Nb(2),p.vc("hidden",i.EditModul),p.Nb(3),p.Jc(i.NodeName),p.Nb(3),p.vc("name",i.HiddenCode?"arrow-dropup":"arrow-dropdown")}}function w(e,t){if(1&e){var n=p.fc();p.ec(0,"ion-toolbar"),p.ec(1,"ion-buttons",12),p.ec(2,"ion-button",13),p.Ic(3," \u603b\u76ee\u5f55 "),p.dc(),p.ec(4,"ion-button",14),p.mc("click",(function(){return p.Bc(n),p.pc().NextRecord(-1)})),p.ac(5,"ion-icon",15),p.dc(),p.ec(6,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().AddContent("\u80cc\u666f")})),p.ac(7,"ion-icon",17),p.ec(8,"ion-text"),p.Ic(9,"\u80cc\u666f"),p.dc(),p.dc(),p.ec(10,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().AddContent("\u53cd\u9988")})),p.ac(11,"ion-icon",17),p.ec(12,"ion-text"),p.Ic(13,"\u53cd\u9988"),p.dc(),p.dc(),p.ec(14,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().AddContent("\u89e3\u8bfb")})),p.ac(15,"ion-icon",17),p.ec(16,"ion-text"),p.Ic(17,"\u89e3\u8bfb"),p.dc(),p.dc(),p.ec(18,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().EidtTitel()})),p.ac(19,"ion-icon",18),p.ec(20,"ion-text"),p.Ic(21,"\u95ee\u5ff5"),p.dc(),p.dc(),p.ec(22,"ion-button",19),p.mc("click",(function(){return p.Bc(n),p.pc().NextRecord(1)})),p.ac(23,"ion-icon",20),p.dc(),p.dc(),p.ec(24,"ion-buttons",9),p.ec(25,"ion-button",10),p.mc("click",(function(){p.Bc(n);var e=p.pc();return e.HiddenCode=!e.HiddenCode})),p.ac(26,"ion-icon",11),p.dc(),p.dc(),p.dc()}if(2&e){var i=p.pc();p.Nb(4),p.vc("disabled",0===i.Index),p.Nb(18),p.vc("disabled",i.Index===i.Length-1),p.Nb(4),p.vc("name",i.HiddenCode?"arrow-dropup":"arrow-dropdown")}}function y(e,t){if(1&e&&(p.ec(0,"div",2),p.ec(1,"div",21),p.Ic(2),p.dc(),p.dc()),2&e){var n=p.pc();p.vc("suiCollapse",!n.HiddenCode),p.Nb(2),p.Kc(" ",n.PanName," ")}}function I(e,t){if(1&e&&p.ac(0,"app-baziview",22),2&e){var n=p.pc();p.vc("Config",n.Config)("BaziText",n.Bazi)}}function N(e,t){if(1&e&&p.ac(0,"app-guaview",23),2&e){var n=p.pc();p.vc("Config",n.Config)("GuaText",n.Gua)}}function R(e,t){if(1&e){var n=p.fc();p.ec(0,"ion-item",24),p.mc("click",(function(){p.Bc(n);var e=t.$implicit;return p.pc().EditContent(e)})),p.ec(1,"ion-note",12),p.Ic(2),p.dc(),p.ec(3,"ion-label",25),p.ac(4,"ion-text",26),p.ec(5,"p"),p.ec(6,"small"),p.Ic(7),p.qc(8,"chinadate"),p.dc(),p.dc(),p.dc(),p.dc()}if(2&e){var i=t.$implicit;p.Nb(2),p.Jc(i.type),p.Nb(2),p.vc("innerHtml",i.text,p.Cc),p.Nb(3),p.Jc(p.rc(8,3,i.time,!0))}}function z(e,t){if(1&e){var n=p.fc();p.ec(0,"ion-footer"),p.ec(1,"ion-toolbar"),p.ec(2,"ion-button",14),p.mc("click",(function(){return p.Bc(n),p.pc().NextRecord(-1)})),p.ac(3,"ion-icon",15),p.dc(),p.ec(4,"ion-buttons"),p.ec(5,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().AddContent("\u80cc\u666f")})),p.ac(6,"ion-icon",17),p.ec(7,"ion-text"),p.Ic(8,"\u80cc\u666f"),p.dc(),p.dc(),p.ec(9,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().AddContent("\u53cd\u9988")})),p.ac(10,"ion-icon",17),p.ec(11,"ion-text"),p.Ic(12,"\u53cd\u9988"),p.dc(),p.dc(),p.ec(13,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().AddContent("\u89e3\u8bfb")})),p.ac(14,"ion-icon",17),p.ec(15,"ion-text"),p.Ic(16,"\u89e3\u8bfb"),p.dc(),p.dc(),p.ec(17,"ion-button",16),p.mc("click",(function(){return p.Bc(n),p.pc().EidtTitel()})),p.ac(18,"ion-icon",18),p.ec(19,"ion-text"),p.Ic(20,"\u95ee\u5ff5"),p.dc(),p.dc(),p.dc(),p.ec(21,"ion-button",19),p.mc("click",(function(){return p.Bc(n),p.pc().NextRecord(1)})),p.ac(22,"ion-icon",20),p.dc(),p.dc(),p.dc()}if(2&e){var i=p.pc();p.Nb(2),p.vc("disabled",0===i.Index),p.Nb(19),p.vc("disabled",i.Index===i.Length-1)}}var B,H=((B=function(){function e(t,n,i,c,o){var r=this;_classCallCheck(this,e),this.route=t,this.dbservice=n,this.setting=i,this.alertCtrl=c,this.modalCtrl=o,this.EditModul=!1,this.index=0,this.smallSymbol=!1,this.HiddenCode=!1,this.HiddenTitel="",this.PanName="\u76d8\u7b26",this.route.params.subscribe((function(e){r.nodeid=e.nodeid,r.recid=e.recid}))}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setting.WaitInit();case 2:return this.guaconfig=Object(u.b)(this.setting.Gua),this.baziconfig=Object(u.b)(this.setting.Bazi),this.content=[],e.next=7,this.dbservice.WaitInit();case 7:this.dbservice.GetRecordes(this.nodeid).then((function(e){t.recordes=e,t.updateRecord()})),this.dbservice.getNodes().then((function(e){var n=e.find((function(e){return e.id===t.nodeid}));t.nodename=n.name})),setTimeout((function(){t.HasGua?t.PanName="\u5366\u540d\uff1a"+t.guaview.GuaInText:t.HasBazi&&(t.PanName="\u516b\u5b57\uff1a"+t.baziview.BaziInText)}),1e3);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"ShowHideCode",value:function(){this.HiddenCode=!this.HiddenCode,!0===this.HiddenCode&&(this.guaview?this.HiddenTitel="".concat(this.guaview.GuaInText," \u95ee: ").concat(this.Record.titel):this.baziview&&(this.HiddenTitel="".concat(this.Record.titel,"(").concat(this.baziview.Gender,"): ").concat(this.baziview.BaziInText)))}},{key:"NextRecord",value:function(e){this.index=this.index+e,this.recid=this.recordes[this.Index].id,this.updateRecord()}},{key:"AddContent",value:function(e){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.EditContent({type:e,time:0,text:""});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"EditContent",value:function(e){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:m,componentProps:{Content:Object(u.b)(e)}});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.next=7,n.onWillDismiss();case 7:i=t.sent,"cancel"!==(c=i.data)&&("delete"===c?this.content=this.content.filter((function(t){return t!==e})):0===c.time?(c.time=Date.now(),this.content.push(c)):(e.time=Date.now(),e.text=c.text),"cancel"!==c&&(this.Record.content=JSON.stringify(this.content),this.dbservice.SaveRecord(this.Record.id,this.Record.node,{content:JSON.stringify(this.content)})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"EidtTitel",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,c,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,this.alertCtrl.create({header:"\u95ee\u5ff5\uff0f\u540d\u5b57",inputs:[{name:"titel",type:"text",id:"titel-id",value:this.Record.titel}],buttons:[{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary"},{text:"\u786e\u5b9a",handler:function(){t=!0}}]});case 3:return n=e.sent,e.next=6,n.present();case 6:return e.next=8,n.onWillDismiss();case 8:i=e.sent,c=i.data,t&&(o=c.values.titel,this.Record.titel=o,this.guaview?(this.gua.question=o,this.Record.arg=JSON.stringify(this.gua),this.guaview.Titel="\u95ee\u5ff5\uff1a"+o):this.baziview&&(this.bazi.person=o,this.Record.arg=JSON.stringify(this.bazi),this.baziview.Person="".concat(o," (").concat(this.baziview.Gender,"\u9020)")),this.dbservice.SaveRecord(this.Record.id,this.Record.node,{titel:o,arg:this.Record.arg}));case 11:case"end":return e.stop()}}),e,this)})))}},{key:"updateRecord",value:function(){var e=this.Record;8===e.type?(this.gua=JSON.parse(e.arg),this.bazi=null):16===e.type&&(this.bazi=JSON.parse(e.arg),this.gua=null),this.content=JSON.parse(e.content||"[]")}},{key:"IsWeb",get:function(){return"web"===g.b}},{key:"Config",get:function(){return this.HasGua?this.guaconfig:this.HasBazi?this.baziconfig:null}},{key:"NodeName",get:function(){return this.nodename||"\u6848\u4f8b"}},{key:"Record",get:function(){var e=this;if(this.recordes){var t=this.recordes.find((function(t){return t.id===e.recid}));return this.index=this.recordes.indexOf(t),t}return null}},{key:"Gua",get:function(){return this.gua}},{key:"Bazi",get:function(){return this.bazi}},{key:"HasGua",get:function(){return!!this.Gua}},{key:"HasBazi",get:function(){return!!this.Bazi}},{key:"Index",get:function(){return this.index}},{key:"Length",get:function(){return(this.recordes||[]).length}},{key:"Content",get:function(){return this.content||[]}}]),e}()).\u0275fac=function(e){return new(e||B)(p.Zb(a.a),p.Zb(h.a),p.Zb(u.a),p.Zb(s.b),p.Zb(s.cb))},B.\u0275cmp=p.Tb({type:B,selectors:[["app-recordviewer"]],viewQuery:function(e,t){var n;1&e&&(p.Nc(l.a,!0),p.Nc(f.a,!0)),2&e&&(p.xc(n=p.nc())&&(t.baziview=n.first),p.xc(n=p.nc())&&(t.guaview=n.first))},decls:11,vars:8,consts:[[4,"ngIf"],[3,"suiCollapse",4,"ngIf"],[3,"suiCollapse"],[2,"margin-bottom","3px"],[3,"Config","BaziText",4,"ngIf"],[3,"Config","GuaText",4,"ngIf"],["lines","inset","detail","","class","ion-text-wrap",3,"click",4,"ngFor","ngForOf"],["slot","start",3,"hidden"],["defaulthref","","text","\u8fd4\u56de"],["slot","end"],[3,"click"],[3,"name"],["slot","start"],["routerLink","/menu/nodes","routerDirection","root"],["size","small","slot","start","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-back"],["size","small",3,"click"],["name","add"],["name","md-clipboard"],["size","small","slot","end","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-forward"],[1,"ui","segment",2,"margin-bottom","3px"],[3,"Config","BaziText"],[3,"Config","GuaText"],["lines","inset","detail","",1,"ion-text-wrap",3,"click"],[1,"ion-text-wrap"],[3,"innerHtml"]],template:function(e,t){1&e&&(p.Gc(0,k,9,3,"ion-header",0),p.Gc(1,w,27,3,"ion-toolbar",0),p.ec(2,"ion-content"),p.Gc(3,y,3,2,"div",1),p.ec(4,"div",2),p.ec(5,"div",3),p.Gc(6,I,1,2,"app-baziview",4),p.Gc(7,N,1,2,"app-guaview",5),p.dc(),p.dc(),p.ec(8,"ion-list"),p.Gc(9,R,9,6,"ion-item",6),p.dc(),p.dc(),p.Gc(10,z,23,2,"ion-footer",0)),2&e&&(p.vc("ngIf",!t.IsWeb),p.Nb(1),p.vc("ngIf",t.IsWeb),p.Nb(2),p.vc("ngIf",t.HasGua||t.HasBazi),p.Nb(1),p.vc("suiCollapse",t.HiddenCode),p.Nb(2),p.vc("ngIf",t.HasBazi),p.Nb(1),p.vc("ngIf",t.HasGua),p.Nb(2),p.vc("ngForOf",t.Content),p.Nb(1),p.vc("ngIf",!t.IsWeb))},directives:[o.j,s.n,C.c,s.E,o.i,s.t,s.Y,s.j,s.f,s.g,s.W,s.i,s.u,s.gb,a.h,s.T,l.a,f.a,s.x,s.H,s.D,s.r],pipes:[x],styles:[""]}),B),G=n("uEAi"),O=n("n7QD");n.d(t,"RecordviewerPageModule",(function(){return _}));var T,E=[{path:"",component:H}],_=((T=function e(){_classCallCheck(this,e)}).\u0275mod=p.Xb({type:T}),T.\u0275inj=p.Wb({factory:function(e){return new(e||T)},imports:[[G.a,O.a,v.b,C.e,o.b,r.c,s.Z,a.j.forChild(E)]]}),T)}}]);