function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{lotG:function(e,t,n){"use strict";n.r(t);var i,c,o=n("ofXK"),r=n("3Pt+"),a=n("tyNb"),s=n("c7TG"),d=n("mrSG"),u=n("LTmD"),l=n("gTpY"),h=n("ylIl"),f=n("HULg"),b=n("+z1p"),g=(n("0eVs"),n("fXoL")),p=n("zioG"),m=((i=function(){function e(t){_classCallCheck(this,e),this.modalCtrl=t,this.Editor=b,this.EditorConfig={toolbar:["heading","|","bold","italic","bulletedList","numberedList","|","link","undo","redo"]}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onSave",value:function(){this.modalCtrl.dismiss(this.Content)}},{key:"onCancel",value:function(){this.modalCtrl.dismiss("cancel")}},{key:"onDelete",value:function(){this.modalCtrl.dismiss("delete")}}]),e}()).\u0275fac=function(e){return new(e||i)(g.Zb(s.db))},i.\u0275cmp=g.Tb({type:i,selectors:[["app-recordcontenteditor"]],inputs:{Content:"Content"},decls:23,vars:5,consts:[["color","secondary"],["slot","start"],[3,"click"],["name","close-circle"],["slot","end"],["name","save"],["scrollY","true"],[3,"ngModel","config","editor","ngModelChange"],["fill","clear","color","danger",3,"hidden","click"],["name","trash"]],template:function(e,t){1&e&&(g.ec(0,"ion-header"),g.ec(1,"ion-toolbar",0),g.ec(2,"ion-buttons",1),g.ec(3,"ion-button",2),g.mc("click",(function(){return t.onCancel()})),g.ac(4,"ion-icon",3),g.ec(5,"ion-text"),g.Hc(6,"\u53d6\u6d88"),g.dc(),g.dc(),g.dc(),g.ec(7,"ion-title"),g.Hc(8),g.dc(),g.ec(9,"ion-buttons",4),g.ec(10,"ion-button",2),g.mc("click",(function(){return t.onSave()})),g.ac(11,"ion-icon",5),g.ec(12,"ion-text"),g.Hc(13,"\u4fdd\u5b58"),g.dc(),g.dc(),g.dc(),g.dc(),g.dc(),g.ec(14,"ion-content",6),g.ec(15,"ckeditor",7),g.mc("ngModelChange",(function(e){return t.Content.text=e})),g.dc(),g.dc(),g.ec(16,"ion-footer"),g.ec(17,"ion-toolbar"),g.ec(18,"ion-buttons",4),g.ec(19,"ion-button",8),g.mc("click",(function(){return t.onDelete()})),g.ac(20,"ion-icon",9),g.ec(21,"ion-label"),g.Hc(22,"\u5220\u9664"),g.dc(),g.dc(),g.dc(),g.dc(),g.dc()),2&e&&(g.Nb(8),g.Jc("\u7f16\u8f91\uff1a",t.Content.type,""),g.Nb(7),g.uc("ngModel",t.Content.text)("config",t.EditorConfig)("editor",t.Editor),g.Nb(4),g.uc("hidden",0===t.Content.time))},directives:[s.t,s.Z,s.j,s.i,s.u,s.U,s.X,s.n,p.a,r.f,r.g,s.r,s.D],styles:[""]}),i),v=n("i/bi"),C=((c=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){return new Date(e).toChinaStr(t)}}]),e}()).\u0275fac=function(e){return new(e||c)},c.\u0275pipe=g.Yb({name:"chinadate",type:c,pure:!0}),c);function w(e,t){if(1&e&&g.ac(0,"app-baziview",17),2&e){var n=g.pc();g.uc("Config",n.Config)("BaziText",n.Bazi)}}function k(e,t){if(1&e&&g.ac(0,"app-guaview",18),2&e){var n=g.pc();g.uc("Config",n.Config)("GuaText",n.Gua)}}function x(e,t){if(1&e){var n=g.fc();g.ec(0,"ion-item",19),g.mc("click",(function(){g.Ac(n);var e=t.$implicit;return g.pc().EditContent(e)})),g.ec(1,"ion-note",20),g.Hc(2),g.dc(),g.ec(3,"ion-label",21),g.ac(4,"ion-text",22),g.ec(5,"p"),g.ec(6,"small"),g.Hc(7),g.qc(8,"chinadate"),g.dc(),g.dc(),g.dc(),g.dc()}if(2&e){var i=t.$implicit;g.Nb(2),g.Ic(i.type),g.Nb(2),g.uc("innerHtml",i.text,g.Bc),g.Nb(3),g.Ic(g.rc(8,3,i.time,!0))}}var y,z=((y=function(){function e(t,n,i,c,o){var r=this;_classCallCheck(this,e),this.route=t,this.dbservice=n,this.setting=i,this.alertCtrl=c,this.modalCtrl=o,this.EditModul=!1,this.index=0,this.smallSymbol=!1,this.HiddenCode=!1,this.HiddenTitel="",this.route.params.subscribe((function(e){r.nodeid=e.nodeid,r.recid=e.recid}))}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setting.WaitInit();case 2:return this.guaconfig=Object(u.b)(this.setting.Gua),this.baziconfig=Object(u.b)(this.setting.Bazi),this.content=[],e.next=7,this.dbservice.WaitInit();case 7:this.dbservice.GetRecordes(this.nodeid).then((function(e){t.recordes=e,t.updateRecord()})),this.dbservice.getNodes().then((function(e){var n=e.find((function(e){return e.id===t.nodeid}));t.nodename=n.name}));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"ShowHideCode",value:function(){this.HiddenCode=!this.HiddenCode,!0===this.HiddenCode&&(this.guaview?this.HiddenTitel="".concat(this.guaview.GuaInText," \u95ee: ").concat(this.Record.titel):this.baziview&&(this.HiddenTitel="".concat(this.Record.titel,"(").concat(this.baziview.Gender,"): ").concat(this.baziview.BaziInText)))}},{key:"NextRecord",value:function(e){this.index=this.index+e,this.recid=this.recordes[this.Index].id,this.updateRecord()}},{key:"AddContent",value:function(e){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.EditContent({type:e,time:0,text:""});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"EditContent",value:function(e){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:m,componentProps:{Content:Object(u.b)(e)}});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.next=7,n.onWillDismiss();case 7:i=t.sent,"cancel"!==(c=i.data)&&("delete"===c?this.content=this.content.filter((function(t){return t!==e})):0===c.time?(c.time=Date.now(),this.content.push(c)):(e.time=Date.now(),e.text=c.text),"cancel"!==c&&(this.Record.content=JSON.stringify(this.content),this.dbservice.SaveRecord(this.Record.id,this.Record.node,{content:JSON.stringify(this.content)})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"EidtTitel",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,c,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,this.alertCtrl.create({header:"\u95ee\u5ff5\uff0f\u540d\u5b57",inputs:[{name:"titel",type:"text",id:"titel-id",value:this.Record.titel}],buttons:[{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary"},{text:"\u786e\u5b9a",handler:function(){t=!0}}]});case 3:return n=e.sent,e.next=6,n.present();case 6:return e.next=8,n.onWillDismiss();case 8:i=e.sent,c=i.data,t&&(o=c.values.titel,this.Record.titel=o,this.guaview?(this.gua.question=o,this.Record.arg=JSON.stringify(this.gua),this.guaview.Titel="\u95ee\u5ff5\uff1a"+o):this.baziview&&(this.bazi.person=o,this.Record.arg=JSON.stringify(this.bazi),this.baziview.Person="".concat(o," (").concat(this.baziview.Gender,"\u9020)")),this.dbservice.SaveRecord(this.Record.id,this.Record.node,{titel:o,arg:this.Record.arg}));case 11:case"end":return e.stop()}}),e,this)})))}},{key:"updateRecord",value:function(){var e=this.Record;8===e.type?(this.gua=JSON.parse(e.arg),this.bazi=null):16===e.type&&(this.bazi=JSON.parse(e.arg),this.gua=null),this.content=JSON.parse(e.content||"[]")}},{key:"Config",get:function(){return this.HasGua?this.guaconfig:this.HasBazi?this.baziconfig:null}},{key:"PanName",get:function(){return this.guaview?this.guaview.GuaInText:this.baziview?this.baziview.BaziInText:"\u76d8\u7b26"}},{key:"NodeName",get:function(){return this.nodename||"\u6848\u4f8b"}},{key:"Record",get:function(){var e=this;if(this.recordes){var t=this.recordes.find((function(t){return t.id===e.recid}));return this.index=this.recordes.indexOf(t),t}return null}},{key:"Gua",get:function(){return this.gua}},{key:"Bazi",get:function(){return this.bazi}},{key:"HasGua",get:function(){return!!this.Gua}},{key:"HasBazi",get:function(){return!!this.Bazi}},{key:"Index",get:function(){return this.index}},{key:"Length",get:function(){return(this.recordes||[]).length}},{key:"Content",get:function(){return this.content||[]}}]),e}()).\u0275fac=function(e){return new(e||y)(g.Zb(a.a),g.Zb(f.a),g.Zb(u.a),g.Zb(s.b),g.Zb(s.db))},y.\u0275cmp=g.Tb({type:y,selectors:[["app-recordviewer"]],viewQuery:function(e,t){var n;1&e&&(g.Mc(l.a,!0),g.Mc(h.a,!0)),2&e&&(g.wc(n=g.nc())&&(t.baziview=n.first),g.wc(n=g.nc())&&(t.guaview=n.first))},decls:40,vars:10,consts:[["slot","start",3,"hidden"],["defaulthref","","text","\u8fd4\u56de"],[3,"closeOthers"],[3,"isOpen","isOpenChange"],["title",""],[1,"dropdown","icon"],["content",""],[3,"Config","BaziText",4,"ngIf"],[3,"Config","GuaText",4,"ngIf"],["lines","inset","detail","","class","ion-text-wrap",3,"click",4,"ngFor","ngForOf"],["size","small","slot","start","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-back"],["size","small",3,"click"],["name","add"],["name","md-clipboard"],["size","small","slot","end","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-forward"],[3,"Config","BaziText"],[3,"Config","GuaText"],["lines","inset","detail","",1,"ion-text-wrap",3,"click"],["slot","start"],[1,"ion-text-wrap"],[3,"innerHtml"]],template:function(e,t){1&e&&(g.ec(0,"ion-header"),g.ec(1,"ion-toolbar"),g.ec(2,"ion-buttons",0),g.ac(3,"ion-back-button",1),g.dc(),g.ec(4,"ion-title"),g.Hc(5),g.dc(),g.dc(),g.dc(),g.ec(6,"ion-content"),g.ec(7,"sui-accordion",2),g.ec(8,"sui-accordion-panel",3),g.mc("isOpenChange",(function(){return t.HiddenCode=!t.HiddenCode})),g.ec(9,"div",4),g.ac(10,"i",5),g.Hc(11),g.dc(),g.ec(12,"div",6),g.Fc(13,w,1,2,"app-baziview",7),g.Fc(14,k,1,2,"app-guaview",8),g.dc(),g.dc(),g.dc(),g.ec(15,"ion-list"),g.Fc(16,x,9,6,"ion-item",9),g.dc(),g.dc(),g.ec(17,"ion-footer"),g.ec(18,"ion-toolbar"),g.ec(19,"ion-button",10),g.mc("click",(function(){return t.NextRecord(-1)})),g.ac(20,"ion-icon",11),g.dc(),g.ec(21,"ion-buttons"),g.ec(22,"ion-button",12),g.mc("click",(function(){return t.AddContent("\u80cc\u666f")})),g.ac(23,"ion-icon",13),g.ec(24,"ion-text"),g.Hc(25,"\u80cc\u666f"),g.dc(),g.dc(),g.ec(26,"ion-button",12),g.mc("click",(function(){return t.AddContent("\u53cd\u9988")})),g.ac(27,"ion-icon",13),g.ec(28,"ion-text"),g.Hc(29,"\u53cd\u9988"),g.dc(),g.dc(),g.ec(30,"ion-button",12),g.mc("click",(function(){return t.AddContent("\u89e3\u8bfb")})),g.ac(31,"ion-icon",13),g.ec(32,"ion-text"),g.Hc(33,"\u89e3\u8bfb"),g.dc(),g.dc(),g.ec(34,"ion-button",12),g.mc("click",(function(){return t.EidtTitel()})),g.ac(35,"ion-icon",14),g.ec(36,"ion-text"),g.Hc(37,"\u95ee\u5ff5"),g.dc(),g.dc(),g.dc(),g.ec(38,"ion-button",15),g.mc("click",(function(){return t.NextRecord(1)})),g.ac(39,"ion-icon",16),g.dc(),g.dc(),g.dc()),2&e&&(g.Nb(2),g.uc("hidden",t.EditModul),g.Nb(3),g.Ic(t.NodeName),g.Nb(2),g.uc("closeOthers",!1),g.Nb(1),g.uc("isOpen",!0),g.Nb(3),g.Jc(" ",t.HiddenCode?"\u6536\u8d77\u76d8\u7b26":t.PanName," "),g.Nb(2),g.uc("ngIf",t.HasBazi),g.Nb(1),g.uc("ngIf",t.HasGua),g.Nb(2),g.uc("ngForOf",t.Content),g.Nb(3),g.uc("disabled",0===t.Index),g.Nb(19),g.uc("disabled",t.Index===t.Length-1))},directives:[s.t,s.Z,s.j,s.f,s.g,s.X,s.n,v.a,v.b,o.j,s.E,o.i,s.r,s.i,s.u,s.U,l.a,h.a,s.x,s.J,s.D],pipes:[C],styles:[""]}),y),N=n("uEAi"),H=n("n7QD");n.d(t,"RecordviewerPageModule",(function(){return T}));var R,O=[{path:"",component:z}],T=((R=function e(){_classCallCheck(this,e)}).\u0275mod=g.Xb({type:R}),R.\u0275inj=g.Wb({factory:function(e){return new(e||R)},imports:[[N.a,H.a,p.b,v.d,o.b,r.c,s.ab,a.i.forChild(O)]]}),R)}}]);