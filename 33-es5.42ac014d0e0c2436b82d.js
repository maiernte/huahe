function _classCallCheck(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,i){for(var t=0;t<i.length;t++){var e=i[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}function _createClass(n,i,t){return i&&_defineProperties(n.prototype,i),t&&_defineProperties(n,t),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{J4mY:function(n,i,t){"use strict";t.r(i);var e,o=t("ofXK"),c=t("3Pt+"),r=t("tyNb"),a=t("c7TG"),u=t("mrSG"),s=t("LTmD"),b=t("PKx9"),l=t("8/yo"),f=t("Y6BA"),h=t("G6JS"),g=t("fXoL"),m=((e=function(){function n(i){_classCallCheck(this,n),this.modalCtrl=i}return _createClass(n,[{key:"ngOnInit",value:function(){}},{key:"onClose",value:function(){this.modalCtrl.dismiss()}}]),n}()).\u0275fac=function(n){return new(n||e)(g.Wb(a.db))},e.\u0275cmp=g.Qb({type:e,selectors:[["app-imgmodal"]],inputs:{ImgSrc:"ImgSrc"},decls:7,vars:1,consts:[["vertical","top=","horizontal","end","slot","fixed",3,"click"],["name","close"],[1,"frame",2,"background-color","black"],[1,"helper"],[3,"src"]],template:function(n,i){1&n&&(g.Zb(0,"ion-content"),g.Zb(1,"ion-fab",0),g.hc("click",(function(){return i.onClose()})),g.Zb(2,"ion-fab-button"),g.Xb(3,"ion-icon",1),g.Yb(),g.Yb(),g.Zb(4,"div",2),g.Xb(5,"span",3),g.Xb(6,"img",4),g.Yb(),g.Yb()),2&n&&(g.Mb(6),g.oc("src",i.ImgSrc,g.tc))},directives:[a.n,a.p,a.q,a.u],styles:[".frame[_ngcontent-%COMP%]{height:100%;width:100%;white-space:nowrap;text-align:center;margin:1em 0}.helper[_ngcontent-%COMP%]{display:inline-block;height:100%}.helper[_ngcontent-%COMP%], img[_ngcontent-%COMP%]{vertical-align:middle}img[_ngcontent-%COMP%]{background:#3a6f9a}"]}),e),p=t("ylIl"),d=t("gTpY");function v(n,i){1&n&&(g.Zb(0,"ion-text",26),g.xc(1,"[\u7cbe\u534e]"),g.Yb())}function x(n,i){1&n&&(g.Zb(0,"ion-text",26),g.xc(1,"[\u7f6e\u9876]"),g.Yb())}function w(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-item"),g.Zb(1,"ion-thumbnail",1),g.Xb(2,"img",27),g.Yb(),g.Zb(3,"ion-label",17),g.Zb(4,"ion-text",28),g.hc("click",(function(){g.rc(t);var n=g.jc();return n.ShowUserInfo(n.Topic.author)})),g.xc(5),g.Yb(),g.Xb(6,"br"),g.Zb(7,"ion-note"),g.Zb(8,"small"),g.xc(9),g.Yb(),g.Yb(),g.Xb(10,"br"),g.Zb(11,"ion-note"),g.Zb(12,"small"),g.xc(13),g.Yb(),g.Yb(),g.Xb(14,"br"),g.Yb(),g.Yb()}if(2&n){var e=g.jc();g.Mb(2),g.oc("src",e.Topic.avatar,g.tc),g.Mb(3),g.zc("\u4f5c\u8005\uff1a",e.Topic.author,""),g.Mb(4),g.zc("\u53d1\u5e16\u65f6\u95f4: ",e.DateText(e.Topic.created),""),g.Mb(4),g.zc("\u4fee\u6539\u65f6\u95f4: ",e.DateText(e.Topic.modified),"")}}function T(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){return g.rc(t),g.jc(2).AnswerTopic(null)})),g.xc(1,"[\u56de\u590d]"),g.Yb()}}function k(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc(2);return n.EditTopic(n.Topic)})),g.xc(1,"[\u4fee\u6539]"),g.Yb()}}function M(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc(2);return n.DeleteTopic(n.Topic.id,!0)})),g.xc(1,"[\u5220\u9664]"),g.Yb()}}function Y(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc(2);return n.FrozenTopic(n.Topic)})),g.xc(1,"[\u5c01\u5b58]"),g.Yb()}}function Z(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",34),g.hc("click",(function(){g.rc(t);var n=g.jc(2);return n.ChangeShowModel(n.Topic,"gua")})),g.xc(1,"[\u5366\u76d8]"),g.Yb()}}function C(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",34),g.hc("click",(function(){g.rc(t);var n=g.jc(2);return n.ChangeShowModel(n.Topic,"bazi")})),g.xc(1,"[\u547d\u76d8]"),g.Yb()}}function I(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",34),g.hc("click",(function(){g.rc(t);var n=g.jc(2);return n.ChangeShowModel(n.Topic,"img")})),g.xc(1,"[\u56fe\u7247]"),g.Yb()}}function y(n,i){if(1&n&&(g.Zb(0,"ion-item",29),g.Zb(1,"small"),g.Zb(2,"ion-label",17),g.Zb(3,"ion-text",30),g.xc(4,"0 \u697c"),g.Yb(),g.wc(5,T,2,0,"ion-text",31),g.wc(6,k,2,0,"ion-text",31),g.wc(7,M,2,0,"ion-text",31),g.wc(8,Y,2,0,"ion-text",31),g.wc(9,Z,2,0,"ion-text",32),g.wc(10,C,2,0,"ion-text",32),g.wc(11,I,2,0,"ion-text",32),g.Yb(),g.Yb(),g.Yb()),2&n){var t=g.jc();g.Mb(5),g.oc("ngIf",t.CheckAction(t.Topic,"anwser")),g.Mb(1),g.oc("ngIf",t.CheckAction(t.Topic,"modify")),g.Mb(1),g.oc("ngIf",t.CheckAction(t.Topic,"delete")),g.Mb(1),g.oc("ngIf",t.CheckAction(t.Topic,"frozen")),g.Mb(1),g.oc("ngIf",t.Topic.gua),g.Mb(1),g.oc("ngIf",t.Topic.bazi),g.Mb(1),g.oc("ngIf",t.Topic.img)}}var j=function(n){return{"max-height.px":n}};function z(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-item",35),g.hc("click",(function(){g.rc(t);var n=g.jc();return n.ShowImageModal(n.Topic.img)})),g.Zb(1,"div",36),g.Xb(2,"img",37),g.Yb(),g.Yb()}if(2&n){var e=g.jc();g.Mb(2),g.oc("src",e.Topic.img,g.tc)("ngStyle",g.pc(2,j,e.MaxHeight))}}function P(n,i){if(1&n&&(g.Zb(0,"ion-item",16),g.Xb(1,"app-guaview",38),g.Yb()),2&n){var t=g.jc();g.Mb(1),g.oc("Config",t.GuaConfig)("GuaText",t.Topic.gua)}}function S(n,i){if(1&n&&(g.Zb(0,"ion-item",16),g.Xb(1,"app-baziview",39),g.Yb()),2&n){var t=g.jc();g.Mb(1),g.oc("Config",t.BaziConfig)("BaziText",t.Topic.bazi)}}function O(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().AnswerTopic(n)})),g.xc(1,"[\u56de\u590d]"),g.Yb()}}function A(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().EditTopic(n)})),g.xc(1,"[\u4fee\u6539]"),g.Yb()}}function X(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().DeleteTopic(n.id,!1)})),g.xc(1,"[\u5220\u9664]"),g.Yb()}}function R(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",33),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().FrozenTopic(n)})),g.xc(1,"[\u5c01\u5b58]"),g.Yb()}}function G(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",34),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().ChangeShowModel(n,"gua")})),g.xc(1,"[\u5366\u76d8]"),g.Yb()}}function D(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",34),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().ChangeShowModel(n,"bazi")})),g.xc(1,"[\u547d\u76d8]"),g.Yb()}}function F(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-text",34),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().ChangeShowModel(n,"img")})),g.xc(1,"[\u56fe\u7247]"),g.Yb()}}function U(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-item",35),g.hc("click",(function(){g.rc(t);var n=g.jc().$implicit;return g.jc().ShowImageModal(n.img)})),g.Zb(1,"div",36),g.Xb(2,"img",37),g.Yb(),g.Yb()}if(2&n){var e=g.jc().$implicit,o=g.jc();g.Mb(2),g.oc("src",e.img,g.tc)("ngStyle",g.pc(2,j,o.MaxHeight))}}function _(n,i){if(1&n&&(g.Zb(0,"ion-item",16),g.Xb(1,"app-guaview",38),g.Yb()),2&n){var t=g.jc().$implicit,e=g.jc();g.Mb(1),g.oc("Config",e.GuaConfig)("GuaText",t.gua)}}function W(n,i){if(1&n&&(g.Zb(0,"ion-item",16),g.Xb(1,"app-baziview",39),g.Yb()),2&n){var t=g.jc().$implicit,e=g.jc();g.Mb(1),g.oc("Config",e.BaziConfig)("BaziText",t.bazi)}}function $(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-item"),g.Zb(1,"div",11),g.Zb(2,"ion-item"),g.Zb(3,"ion-thumbnail",1),g.Xb(4,"img",27),g.Yb(),g.Zb(5,"ion-label",17),g.Zb(6,"ion-text",28),g.hc("click",(function(){g.rc(t);var n=i.$implicit;return g.jc().ShowUserInfo(n.author)})),g.xc(7),g.Yb(),g.Xb(8,"br"),g.Zb(9,"ion-note"),g.Zb(10,"small"),g.xc(11),g.Yb(),g.Yb(),g.Xb(12,"br"),g.Zb(13,"ion-note"),g.Zb(14,"small"),g.xc(15),g.Yb(),g.Yb(),g.Xb(16,"br"),g.Yb(),g.Yb(),g.Zb(17,"ion-item",29),g.Zb(18,"ion-label",17),g.Zb(19,"ion-text",30),g.xc(20),g.Yb(),g.wc(21,O,2,0,"ion-text",31),g.wc(22,A,2,0,"ion-text",31),g.wc(23,X,2,0,"ion-text",31),g.wc(24,R,2,0,"ion-text",31),g.wc(25,G,2,0,"ion-text",32),g.wc(26,D,2,0,"ion-text",32),g.wc(27,F,2,0,"ion-text",32),g.Yb(),g.Yb(),g.wc(28,U,3,4,"ion-item",14),g.wc(29,_,2,2,"ion-item",15),g.wc(30,W,2,2,"ion-item",15),g.Zb(31,"ion-item",16),g.Zb(32,"ion-label",17),g.Xb(33,"ion-text",18),g.Yb(),g.Yb(),g.Yb(),g.Yb()}if(2&n){var e=i.$implicit,o=i.index,c=g.jc();g.Mb(4),g.oc("src",e.avatar,g.tc),g.Mb(3),g.zc("\u4f5c\u8005\uff1a",e.author,""),g.Mb(4),g.zc("\u53d1\u5e16\u65f6\u95f4: ",c.DateText(e.created),""),g.Mb(4),g.zc("\u4fee\u6539\u65f6\u95f4: ",c.DateText(e.modified),""),g.Mb(5),g.zc("",o+1,"\u697c"),g.Mb(1),g.oc("ngIf",c.CheckAction(e,"anwser")),g.Mb(1),g.oc("ngIf",c.CheckAction(e,"modify")),g.Mb(1),g.oc("ngIf",c.CheckAction(e,"delete")),g.Mb(1),g.oc("ngIf",c.CheckAction(e,"frozen")),g.Mb(1),g.oc("ngIf",e.gua),g.Mb(1),g.oc("ngIf",e.bazi),g.Mb(1),g.oc("ngIf",e.img),g.Mb(1),g.oc("ngIf",c.ShowMe(e,"img")),g.Mb(1),g.oc("ngIf",c.ShowMe(e,"gua")),g.Mb(1),g.oc("ngIf",c.ShowMe(e,"bazi")),g.Mb(3),g.oc("innerHtml",e.content,g.sc)}}function H(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-button",35),g.hc("click",(function(){g.rc(t);var n=g.jc();return n.ShowPanfu(n.Topic.gua)})),g.xc(1,"\u5366\u76d8"),g.Yb()}}function B(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-button",35),g.hc("click",(function(){g.rc(t);var n=g.jc();return n.ShowPanfu(n.Topic.bazi)})),g.xc(1,"\u547d\u76d8"),g.Yb()}}function L(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-button",40),g.hc("click",(function(){return g.rc(t),g.jc().SetTopOrGood("\u7cbe\u534e")})),g.xc(1,"[\u7cbe\u534e]"),g.Yb()}if(2&n){var e=g.jc();g.oc("color",null!=e.Topic&&e.Topic.good?"primary":"danger")}}function E(n,i){if(1&n){var t=g.ac();g.Zb(0,"ion-button",40),g.hc("click",(function(){return g.rc(t),g.jc().SetTopOrGood("\u7f6e\u9876")})),g.xc(1,"[\u7f6e\u9876]"),g.Yb()}if(2&n){var e=g.jc();g.oc("color",null!=e.Topic&&e.Topic.top?"primary":"danger")}}function V(n,i){if(1&n&&(g.Zb(0,"ion-select-option",41),g.xc(1),g.Yb()),2&n){var t=i.$implicit;g.oc("value",t),g.Mb(1),g.zc("\u7b2c",t+1,"\u9875")}}var J,Q=((J=function(){function n(i,t,e,o,c,r,a){var u=this;_classCallCheck(this,n),this.loadingController=i,this.alertController=t,this.settings=e,this.forumservice=o,this.modalCtrl=c,this.route=r,this.router=a,this.pageindex=0,this.Pages=[0],this.Titel="Topic Titel",this.VTopic=[],this.route.params.subscribe((function(n){u.forumid=n.forumid,u.topicid=n.topicid}))}return _createClass(n,[{key:"ngOnInit",value:function(){var n;return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.settings.WaitInit();case 2:if(i.t0=this.forumservice.ForumMG.Forumlist,i.t0){i.next=6;break}return i.next=6,this.forumservice.LoadForumList();case 6:return this.forum=this.forumservice.ForumMG.Forumlist.find((function(n){return n.id===t.forumid})),this.Titel=(null===(n=this.forum)||void 0===n?void 0:n.name)||this.forumid,this.user=this.settings.User||f.a,this.GuaConfig=this.settings.Gua,this.BaziConfig=this.settings.Bazi,i.next=13,this.loadingController.create({message:"\u6b63\u5728\u83b7\u53d6\u8bba\u575b\u5e16\u5b50...",duration:6e4});case 13:return this.loadingView=i.sent,i.next=16,this.forumservice.GetTopic(this.forumid,this.topicid);case 16:this.Topic=i.sent,this.PageIndex=0;case 18:case"end":return i.stop()}}),i,this)})))}},{key:"LoadAnswors",value:function(n){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:this.forumservice.LoadAnswerList(this.topicid,this.forumid,n).then((function(n){n&&Array.isArray(n.data)&&(t.BuildPages(n.sum),t.VTopic=n.data,t.updateUserAvatar())})).catch((function(n){console.log("LoadAnswors Error",n)}));case 1:case"end":return i.stop()}}),i,this)})))}},{key:"DateText",value:function(n){if(!n)return"\u65e0";var i=new Date(n);return i.toChinaStr()+" ".concat(i.getHours(),":").concat(i.getMinutes(),":").concat(i.getSeconds())}},{key:"ShowMe",value:function(n,i){return"img"===i?n&&n.img&&n.showimg:"gua"===i?n&&n.gua&&n.showgua:"bazi"===i&&n&&n.bazi&&n.showbazi}},{key:"ChangeShowModel",value:function(n,i){if(n){var t=this.settings.ForumSetting;if("img"===i)t.imgOut?this.ShowPanfu({img:btoa(n.img)}):n.showimg=!n.showimg;else if("gua"===i)t.guaOut?this.ShowPanfu(n.gua):n.showgua=!n.showgua;else{if("bazi"!==i)return!1;t.baziOut?this.ShowPanfu(n.bazi):n.showbazi=!n.showbazi}}}},{key:"GetRoles",value:function(n){return n?this.settings.UserRolers(n):[]}},{key:"CheckAction",value:function(n,i){if(!n||!this.HasUser)return!1;var t=!1;return"modify"===i?t=(t=this.user.id===n.author||this.IsAdmin)&&!0!==n.frozen:"delete"===i?t=(t=this.user.id===n.author||this.IsAdmin)&&!0!==n.frozen:"frozen"===i?t=(t=this.user.id===n.author||this.IsAdmin)&&!0!==n.frozen:"anwser"===i&&(t=!0),t&&!(!0===n.deleted)}},{key:"ShowPanfu",value:function(n){this.router.navigate(["menu/topicpanfu/".concat(JSON.stringify(n))])}},{key:"EditTopic",value:function(n){var i;return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,o,c,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=void 0!==n.forumid,(o=e?null===(i=this.forum)||void 0===i?void 0:i.name:this.Topic.title)||(o=n.forumid||this.forumid),t.next=5,this.modalCtrl.create({component:l.a,componentProps:{MainTopic:e?n:null,VTopic:e?null:n,forumid:this.forumid,forumname:o,Private:!this.forum}});case 5:return c=t.sent,t.next=8,c.present();case 8:return t.next=10,c.onWillDismiss();case 10:r=t.sent,a=r.data,console.log("new Topic return ",a);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"DeleteTopic",value:function(n,i){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.presentConfirm("\u5220\u9664",null,"\u786e\u5b9a\u5220\u9664\u6b64\u5e16\u5b50/\u53d1\u8a00\uff1f").then((function(t){return!0===t&&e.forumservice.DeleteTopic(n,i?null:e.Topic.id)})).then((function(n){n&&e.router.navigateByUrl(i?"menu/forum":"menu/topiclist/".concat(e.forumid))}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"AnswerTopic",value:function(n){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t,e;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.CreateTopic(n),i.next=3,this.modalCtrl.create({component:l.a,componentProps:{VTopic:t,forumid:this.forumid,forumname:this.Topic.title}});case 3:return e=i.sent,i.next=6,e.present();case 6:return i.next=8,e.onWillDismiss();case 8:case"end":return i.stop()}}),i,this)})))}},{key:"FrozenTopic",value:function(n){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t,e=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=!n,n=n||this.Topic,this.presentConfirm("\u5c01\u5b58",null,"\u5c01\u5b58\u53d1\u8a00\u540e\uff0c\u4e0d\u5141\u8bb8\u518d\u4fee\u6539\u3001\u5220\u9664\u3002\u5168\u697c\u5c01\u5b58\u540e\u4e0d\u5141\u8bb8\u8ddf\u8d34\u3002\u786e\u5b9a\u5c01\u5b58\u5417\uff1f").then((function(i){if(!0===i)return e.forumservice.UpdateTopic({frozen:!0},n.id,!e.forum)})).then((function(i){i&&(n.frozen=!0,n.deleted=!!t||n.deleted)})).catch((function(n){e.presentConfirm("\u64cd\u4f5c\u5931\u8d25",null,"\u5c01\u697c/\u53d1\u8a00\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff0c \u6216\u8005\u5411\u7248\u4e3b\u62a5\u544a\u3002")}));case 2:case"end":return i.stop()}}),i,this)})))}},{key:"SetTopOrGood",value:function(n){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t,e=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t={},"\u7cbe\u534e"===n?t.good=!this.Topic.good:"\u7f6e\u9876"===n&&(t.top=(this.Topic.top+1)%2),this.forumservice.UpdateTopic(t,this.Topic.id,!this.forum).then((function(i){i&&("\u7cbe\u534e"===n?e.Topic.good=!e.Topic.good:"\u7f6e\u9876"===n&&(e.Topic.top=(e.Topic.top+1)%2))}));case 2:case"end":return i.stop()}}),i,this)})))}},{key:"ShowUserInfo",value:function(n){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.modalCtrl.create({component:h.a,componentProps:{Uerid:n}});case 2:return t=i.sent,i.next=5,t.present();case 5:return i.next=7,t.onWillDismiss();case 7:case"end":return i.stop()}}),i,this)})))}},{key:"ShowImageModal",value:function(n){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var t;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.modalCtrl.create({component:m,componentProps:{ImgSrc:n}});case 2:return t=i.sent,i.next=5,t.present();case 5:return i.next=7,t.onWillDismiss();case 7:case"end":return i.stop()}}),i,this)})))}},{key:"CreateTopic",value:function(n){var i=Date.now();return{id:"",created:i,modified:i,author:this.user.id,topic:this.Topic.id,gua:null,bazi:null,img:null,content:"",feedback:n||"",frozen:!1}}},{key:"updateUserAvatar",value:function(){var n=this,i=this.settings.ForumSetting;this.VTopic.forEach((function(t){n.forumservice.GetUserInfo(t.author).then((function(e){var o=(e||f.a).avatar||"";t.avatar=o.IsNullOrEmpty()?n.settings.Avatar(e.gender):o,t.showimg=i.showimg&&!i.imgOut,t.showgua=i.showgua&&!i.guaOut,t.showbazi=i.showbazi&&!i.baziOut}))}))}},{key:"presentConfirm",value:function(n,i,t){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=!1,e.next=3,this.alertController.create({header:n||"\u63d0\u793a",subHeader:i||"",message:t,buttons:[{text:"\u786e\u5b9a",handler:function(){o=!0}},{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary",handler:function(){}}]});case 3:return c=e.sent,e.next=6,c.present();case 6:return e.next=8,c.onWillDismiss();case 8:return e.abrupt("return",Promise.resolve(o));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"BuildPages",value:function(n){if(0===this.PageIndex)if(0!==n){this.Pages=[];for(var i=Math.ceil(n/20),t=0;t<i;t++)this.Pages.push(t)}else this.Pages=[0]}},{key:"HasUser",get:function(){return this.settings.HasUser&&this.user!==f.a}},{key:"PageIndex",get:function(){return this.pageindex},set:function(n){this.pageindex=n,this.LoadAnswors(n)}},{key:"MaxHeight",get:function(){return Math.ceil(this.settings.DeviceHeight/2)}},{key:"IsAdmin",get:function(){if(!this.user||!this.forum)return!1;var n=256===this.user.roller;return this.forum&&this.Topic&&(n=n||this.forum.admin.includes(this.user.id)),n}}]),n}()).\u0275fac=function(n){return new(n||J)(g.Wb(a.cb),g.Wb(a.b),g.Wb(s.a),g.Wb(b.a),g.Wb(a.db),g.Wb(r.a),g.Wb(r.g))},J.\u0275cmp=g.Qb({type:J,selectors:[["app-topicviewer"]],decls:46,vars:20,consts:[["color","primary"],["slot","start"],["defaulthref","","text","\u8fd4\u56de"],["slot","end"],["routerLink","/menu/forum"],["icon-only","","name","home"],["color","medium"],["ion-no-padding",""],["color","danger",4,"ngIf"],[3,"disabled","click"],["lines","full"],[2,"padding-bottom","3px"],[4,"ngIf"],["lines","none","class","ion-no-margin",4,"ngIf"],[3,"click",4,"ngIf"],["lines","none",4,"ngIf"],["lines","none"],[1,"ion-text-wrap"],["ion-padding-vertical","","color","success",2,"margin-bottom","1px",3,"innerHtml"],[4,"ngFor","ngForOf"],[3,"color","click",4,"ngIf"],["name","arrow-back"],["cancelText","\u53d6\u6d88","doneText","\u786e\u5b9a",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"small",3,"disabled","click"],["name","arrow-forward"],["color","danger"],[3,"src"],["color","primary",3,"click"],["lines","none",1,"ion-no-margin"],["slot","end",1,"ion-margin-end"],["color","secondary","class","ion-margin-end",3,"click",4,"ngIf"],["color","warning","class","ion-margin-end",3,"click",4,"ngIf"],["color","secondary",1,"ion-margin-end",3,"click"],["color","warning",1,"ion-margin-end",3,"click"],[3,"click"],[1,"img-container"],[3,"src","ngStyle"],[3,"Config","GuaText"],[3,"Config","BaziText"],[3,"color","click"],[3,"value"]],template:function(n,i){1&n&&(g.Zb(0,"ion-header"),g.Zb(1,"ion-toolbar",0),g.Zb(2,"ion-buttons",1),g.Xb(3,"ion-back-button",2),g.Yb(),g.Zb(4,"ion-title"),g.xc(5),g.Yb(),g.Zb(6,"ion-buttons",3),g.Zb(7,"ion-button",4),g.Xb(8,"ion-icon",5),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.Xb(9,"ion-text",6),g.Zb(10,"ion-item-divider",7),g.Zb(11,"ion-label",1),g.Zb(12,"ion-text"),g.xc(13),g.Yb(),g.wc(14,v,2,0,"ion-text",8),g.wc(15,x,2,0,"ion-text",8),g.Yb(),g.Zb(16,"ion-buttons",3),g.Zb(17,"ion-button",9),g.hc("click",(function(){return i.FrozenTopic(null)})),g.xc(18,"\u5c01\u697c"),g.Yb(),g.Yb(),g.Yb(),g.Zb(19,"ion-content"),g.Zb(20,"ion-item",10),g.Zb(21,"div",11),g.wc(22,w,15,4,"ion-item",12),g.wc(23,y,12,7,"ion-item",13),g.wc(24,z,3,4,"ion-item",14),g.wc(25,P,2,2,"ion-item",15),g.wc(26,S,2,2,"ion-item",15),g.Zb(27,"ion-item",16),g.Zb(28,"ion-label",17),g.Xb(29,"ion-text",18),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.wc(30,$,34,16,"ion-item",19),g.Yb(),g.Zb(31,"ion-footer"),g.Zb(32,"small"),g.Zb(33,"ion-toolbar"),g.Zb(34,"ion-buttons",1),g.wc(35,H,2,0,"ion-button",14),g.wc(36,B,2,0,"ion-button",14),g.wc(37,L,2,1,"ion-button",20),g.wc(38,E,2,1,"ion-button",20),g.Yb(),g.Zb(39,"ion-buttons",3),g.Zb(40,"ion-button",9),g.hc("click",(function(){return i.PageIndex=i.PageIndex-1})),g.Xb(41,"ion-icon",21),g.Yb(),g.Zb(42,"ion-select",22),g.hc("ngModelChange",(function(n){return i.PageIndex=n})),g.wc(43,V,2,2,"ion-select-option",23),g.Yb(),g.Zb(44,"ion-button",24),g.hc("click",(function(){return i.PageIndex=i.PageIndex+1})),g.Xb(45,"ion-icon",25),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.Yb()),2&n&&(g.Mb(5),g.yc(i.Titel),g.Mb(8),g.zc("\u9898\u76ee\uff1a",null==i.Topic?null:i.Topic.title,""),g.Mb(1),g.oc("ngIf",null==i.Topic?null:i.Topic.good),g.Mb(1),g.oc("ngIf",null==i.Topic?null:i.Topic.top),g.Mb(2),g.oc("disabled",!i.CheckAction(i.Topic,"frozen")),g.Mb(5),g.oc("ngIf",i.Topic),g.Mb(1),g.oc("ngIf",i.Topic),g.Mb(1),g.oc("ngIf",i.ShowMe(i.Topic,"img")),g.Mb(1),g.oc("ngIf",i.ShowMe(i.Topic,"gua")),g.Mb(1),g.oc("ngIf",i.ShowMe(i.Topic,"bazi")),g.Mb(3),g.oc("innerHtml",null==i.Topic?null:i.Topic.content,g.sc),g.Mb(1),g.oc("ngForOf",i.VTopic),g.Mb(5),g.oc("ngIf",null==i.Topic?null:i.Topic.gua),g.Mb(1),g.oc("ngIf",null==i.Topic?null:i.Topic.bazi),g.Mb(1),g.oc("ngIf",i.IsAdmin),g.Mb(1),g.oc("ngIf",i.IsAdmin),g.Mb(2),g.oc("disabled",0===i.PageIndex),g.Mb(2),g.oc("ngModel",i.PageIndex),g.Mb(1),g.oc("ngForOf",i.Pages),g.Mb(1),g.oc("disabled",i.PageIndex===i.Pages.length-1))},directives:[a.t,a.Z,a.j,a.f,a.g,a.X,a.i,a.hb,r.h,a.u,a.U,a.y,a.D,o.j,a.n,a.x,o.i,a.r,a.Q,a.ib,c.c,c.d,a.W,a.J,o.k,p.a,d.a,a.R],styles:[".img-container[_ngcontent-%COMP%]{text-align:center;display:block}"]}),J),N=t("CGrG"),K=t("zioG"),q=t("uEAi"),nn=t("n7QD");t.d(i,"TopicviewerPageModule",(function(){return on}));var tn,en=[{path:"",component:Q}],on=((tn=function n(){_classCallCheck(this,n)}).\u0275mod=g.Ub({type:tn}),tn.\u0275inj=g.Tb({factory:function(n){return new(n||tn)},imports:[[q.a,nn.a,K.b,o.b,c.a,a.ab,N.b,r.i.forChild(en)]]}),tn)}}]);