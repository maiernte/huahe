function _classCallCheck(e,c){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,c){for(var i=0;i<c.length;i++){var n=c[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,c,i){return c&&_defineProperties(e.prototype,c),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{J4mY:function(e,c,i){"use strict";i.r(c);var n,t,o=i("ofXK"),r=i("3Pt+"),a=i("tyNb"),s=i("c7TG"),u=i("mrSG"),l=i("LTmD"),f=i("PKx9"),d=i("8/yo"),m=i("Y6BA"),p=i("G6JS"),h=i("fXoL"),g=((n=function(){function e(c){_classCallCheck(this,e),this.modalCtrl=c}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onClose",value:function(){this.modalCtrl.dismiss()}}]),e}()).\u0275fac=function(e){return new(e||n)(h.Zb(s.cb))},n.\u0275cmp=h.Tb({type:n,selectors:[["app-imgmodal"]],inputs:{ImgSrc:"ImgSrc"},decls:7,vars:1,consts:[["vertical","bottom","horizontal","end","slot","fixed",3,"click"],["name","close"],[1,"frame",2,"background-color","black"],[1,"helper"],[3,"src"]],template:function(e,c){1&e&&(h.ec(0,"ion-content"),h.ec(1,"ion-fab",0),h.mc("click",(function(){return c.onClose()})),h.ec(2,"ion-fab-button"),h.ac(3,"ion-icon",1),h.dc(),h.dc(),h.ec(4,"div",2),h.ac(5,"span",3),h.ac(6,"img",4),h.dc(),h.dc()),2&e&&(h.Nb(6),h.wc("src",c.ImgSrc,h.Ec))},directives:[s.n,s.p,s.q,s.u],styles:[".frame[_ngcontent-%COMP%]{height:100%;width:100%;white-space:nowrap;text-align:center;margin:1em 0}.helper[_ngcontent-%COMP%]{display:inline-block;height:100%}.helper[_ngcontent-%COMP%], img[_ngcontent-%COMP%]{vertical-align:middle}img[_ngcontent-%COMP%]{background:#3a6f9a}"]}),n),v=i("i/bi"),b=i("ylIl"),w=i("gTpY"),T=i("jhN1"),k=((t=function(){function e(c){_classCallCheck(this,e),this.sanitizer=c}return _createClass(e,[{key:"transform",value:function(e){return this.sanitizer.bypassSecurityTrustHtml(e)}}]),e}()).\u0275fac=function(e){return new(e||t)(h.Zb(T.b))},t.\u0275pipe=h.Yb({name:"safeHtml",type:t,pure:!0}),t);function x(e,c){if(1&e&&(h.ec(0,"ion-header"),h.ec(1,"ion-toolbar",11),h.ec(2,"ion-buttons",3),h.ac(3,"ion-back-button",12),h.dc(),h.ec(4,"ion-title"),h.Jc(5),h.dc(),h.ec(6,"ion-buttons",5),h.ec(7,"ion-button",13),h.ac(8,"ion-icon",14),h.dc(),h.dc(),h.dc(),h.dc()),2&e){var i=h.pc();h.Nb(5),h.Kc(i.Titel)}}function C(e,c){1&e&&(h.ec(0,"ion-text",15),h.Jc(1,"[\u7cbe\u534e]"),h.dc())}function y(e,c){1&e&&(h.ec(0,"ion-text",15),h.Jc(1,"[\u7f6e\u9876]"),h.dc())}function I(e,c){if(1&e){var i=h.fc();h.ec(0,"ion-button",16),h.mc("click",(function(){return h.Cc(i),h.pc().NavBack()})),h.ac(1,"ion-icon",17),h.dc()}}function N(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){return h.Cc(i),h.pc(2).AnswerTopic(null)})),h.Jc(2,"[\u56de\u590d]"),h.dc(),h.dc()}}function z(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc(2);return e.EditTopic(e.Topic)})),h.Jc(2,"[\u4fee\u6539]"),h.dc(),h.dc()}}function H(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc(2);return e.DeleteTopic(e.Topic.id,!0)})),h.Jc(2,"[\u5220\u9664]"),h.dc(),h.dc()}}function S(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc(2);return e.FrozenTopic(e.Topic)})),h.Jc(2,"[\u5c01\u5b58]"),h.dc(),h.dc()}}function O(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc(2);return e.ChangeImg(e.Topic,"img")})),h.Jc(2,"[\u56fe\u7247]"),h.dc(),h.dc()}}function J(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",26),h.mc("click",(function(){return h.Cc(i),h.pc(2).SetTopOrGood("\u7cbe\u534e")})),h.Jc(2,"[\u7cbe\u534e]"),h.dc(),h.dc()}if(2&e){var n=h.pc(2);h.Nb(1),h.wc("color",null!=n.Topic&&n.Topic.good?"primary":"danger")}}function A(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",27),h.mc("click",(function(){return h.Cc(i),h.pc(2).SetTopOrGood("\u7f6e\u9876")})),h.Jc(2,"[\u7f6e\u9876]"),h.dc(),h.dc()}if(2&e){var n=h.pc(2);h.Nb(1),h.wc("color",null!=n.Topic&&n.Topic.top?"primary":"danger")}}function P(e,c){if(1&e&&(h.ec(0,"sui-accordion",28),h.ec(1,"sui-accordion-panel",29),h.ec(2,"div",30),h.ac(3,"i",31),h.Jc(4," \u5366\u76d8 "),h.dc(),h.ec(5,"div",32),h.ac(6,"app-guaview",33),h.dc(),h.dc(),h.dc()),2&e){var i=h.pc(2);h.wc("closeOthers",!1),h.Nb(1),h.wc("isOpen",!1),h.Nb(5),h.wc("Config",i.GuaConfig)("GuaText",i.Topic.gua)}}function L(e,c){if(1&e&&(h.ec(0,"sui-accordion",28),h.ec(1,"sui-accordion-panel",29),h.ec(2,"div",30),h.ac(3,"i",31),h.Jc(4," \u547d\u76d8 "),h.dc(),h.ec(5,"div",32),h.ac(6,"app-baziview",34),h.dc(),h.dc(),h.dc()),2&e){var i=h.pc(2);h.wc("closeOthers",!1),h.Nb(1),h.wc("isOpen",!1),h.Nb(5),h.wc("Config",i.BaziConfig)("BaziText",i.Topic.bazi)}}var R=function(e){return{"max-height.px":e}};function G(e,c){if(1&e){var i=h.fc();h.ec(0,"ion-item",35),h.mc("click",(function(){h.Cc(i);var e=h.pc(2);return e.ShowImageModal(e.Topic.img)})),h.ec(1,"div",36),h.ac(2,"img",37),h.dc(),h.dc()}if(2&e){var n=h.pc(2);h.Nb(2),h.wc("src",n.Topic.img,h.Ec)("ngStyle",h.xc(2,R,n.MaxHeight))}}function D(e,c){if(1&e){var i=h.fc();h.ec(0,"div"),h.ec(1,"ion-item"),h.ec(2,"ion-thumbnail",3),h.ac(3,"img",18),h.dc(),h.ec(4,"ion-label",19),h.ec(5,"ion-text",20),h.mc("click",(function(){h.Cc(i);var e=h.pc();return e.ShowUserInfo(e.Topic.author)})),h.Jc(6),h.dc(),h.ac(7,"br"),h.ec(8,"ion-note"),h.ec(9,"small"),h.Jc(10),h.dc(),h.dc(),h.ac(11,"br"),h.ec(12,"ion-note"),h.ec(13,"small"),h.Jc(14),h.dc(),h.dc(),h.ac(15,"br"),h.ec(16,"ion-label",19),h.ec(17,"small"),h.ec(18,"ion-text",21),h.Jc(19,"0 \u697c"),h.dc(),h.dc(),h.Hc(20,N,3,0,"small",0),h.Hc(21,z,3,0,"small",0),h.Hc(22,H,3,0,"small",0),h.Hc(23,S,3,0,"small",0),h.Hc(24,O,3,0,"small",0),h.Hc(25,J,3,1,"small",0),h.Hc(26,A,3,1,"small",0),h.dc(),h.dc(),h.dc(),h.Hc(27,P,7,4,"sui-accordion",22),h.Hc(28,L,7,4,"sui-accordion",22),h.Hc(29,G,3,4,"ion-item",23),h.ec(30,"ion-item"),h.ec(31,"ion-label",19),h.ac(32,"ion-text",24),h.qc(33,"safeHtml"),h.dc(),h.dc(),h.dc()}if(2&e){var n=h.pc();h.Nb(3),h.wc("src",n.Topic.avatar,h.Ec),h.Nb(3),h.Lc("\u4f5c\u8005\uff1a",n.Topic.author,""),h.Nb(4),h.Lc("\u53d1\u5e16\u65f6\u95f4: ",n.DateText(n.Topic.created),""),h.Nb(4),h.Lc("\u4fee\u6539\u65f6\u95f4: ",n.DateText(n.Topic.modified),""),h.Nb(6),h.wc("ngIf",n.CheckAction(n.Topic,"anwser")),h.Nb(1),h.wc("ngIf",n.CheckAction(n.Topic,"modify")),h.Nb(1),h.wc("ngIf",n.CheckAction(n.Topic,"delete")),h.Nb(1),h.wc("ngIf",n.CheckAction(n.Topic,"frozen")),h.Nb(1),h.wc("ngIf",n.Topic.img),h.Nb(1),h.wc("ngIf",n.IsAdmin),h.Nb(1),h.wc("ngIf",n.IsAdmin),h.Nb(1),h.wc("ngIf",n.Topic.gua),h.Nb(1),h.wc("ngIf",n.Topic.bazi),h.Nb(1),h.wc("ngIf",n.ShowMe(n.Topic,"img")),h.Nb(3),h.wc("innerHtml",h.rc(33,15,n.Topic.content),h.Dc)}}function M(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){return h.Cc(i),h.pc(2).AnswerTopic(null)})),h.Jc(2,"[\u56de\u590d]"),h.dc(),h.dc()}}function B(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc().$implicit;return h.pc().EditTopic(e)})),h.Jc(2,"[\u4fee\u6539]"),h.dc(),h.dc()}}function _(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc().$implicit;return h.pc().DeleteTopic(e.id,!0)})),h.Jc(2,"[\u5220\u9664]"),h.dc(),h.dc()}}function j(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc().$implicit;return h.pc().FrozenTopic(e)})),h.Jc(2,"[\u5c01\u5b58]"),h.dc(),h.dc()}}function U(e,c){if(1&e){var i=h.fc();h.ec(0,"small"),h.ec(1,"ion-text",25),h.mc("click",(function(){h.Cc(i);var e=h.pc().$implicit;return h.pc().ChangeImg(e,"img")})),h.Jc(2,"[\u56fe\u7247]"),h.dc(),h.dc()}}function E(e,c){if(1&e&&(h.ec(0,"sui-accordion",28),h.ec(1,"sui-accordion-panel",29),h.ec(2,"div",30),h.ac(3,"i",31),h.Jc(4," \u5366\u76d8 "),h.dc(),h.ec(5,"div",32),h.ac(6,"app-guaview",33),h.dc(),h.dc(),h.dc()),2&e){var i=h.pc().$implicit,n=h.pc();h.wc("closeOthers",!1),h.Nb(1),h.wc("isOpen",!1),h.Nb(5),h.wc("Config",n.GuaConfig)("GuaText",i.gua)}}function F(e,c){if(1&e&&(h.ec(0,"sui-accordion",28),h.ec(1,"sui-accordion-panel",29),h.ec(2,"div",30),h.ac(3,"i",31),h.Jc(4," \u547d\u76d8 "),h.dc(),h.ec(5,"div",32),h.ac(6,"app-baziview",34),h.dc(),h.dc(),h.dc()),2&e){var i=h.pc().$implicit,n=h.pc();h.wc("closeOthers",!1),h.Nb(1),h.wc("isOpen",!1),h.Nb(5),h.wc("Config",n.BaziConfig)("BaziText",i.bazi)}}function W(e,c){if(1&e){var i=h.fc();h.ec(0,"ion-item",35),h.mc("click",(function(){h.Cc(i);var e=h.pc().$implicit;return h.pc().ShowImageModal(e.img)})),h.ec(1,"div",36),h.ac(2,"img",37),h.dc(),h.dc()}if(2&e){var n=h.pc().$implicit,t=h.pc();h.Nb(2),h.wc("src",n.img,h.Ec)("ngStyle",h.xc(2,R,t.MaxHeight))}}function Z(e,c){if(1&e){var i=h.fc();h.ec(0,"ion-item"),h.ec(1,"div",38),h.ec(2,"ion-item"),h.ec(3,"ion-thumbnail",3),h.ac(4,"img",18),h.dc(),h.ec(5,"ion-label",19),h.ec(6,"ion-text",20),h.mc("click",(function(){h.Cc(i);var e=c.$implicit;return h.pc().ShowUserInfo(e.author)})),h.Jc(7),h.dc(),h.ac(8,"br"),h.ec(9,"ion-note"),h.ec(10,"small"),h.Jc(11),h.dc(),h.dc(),h.ac(12,"br"),h.ec(13,"ion-note"),h.ec(14,"small"),h.Jc(15),h.dc(),h.dc(),h.ac(16,"br"),h.ec(17,"ion-label",19),h.ec(18,"small"),h.ec(19,"ion-text",21),h.Jc(20),h.dc(),h.dc(),h.Hc(21,M,3,0,"small",0),h.Hc(22,B,3,0,"small",0),h.Hc(23,_,3,0,"small",0),h.Hc(24,j,3,0,"small",0),h.Hc(25,U,3,0,"small",0),h.dc(),h.dc(),h.dc(),h.Hc(26,E,7,4,"sui-accordion",22),h.Hc(27,F,7,4,"sui-accordion",22),h.Hc(28,W,3,4,"ion-item",23),h.ec(29,"ion-item",39),h.ec(30,"ion-label",19),h.ac(31,"ion-text",24),h.dc(),h.dc(),h.dc(),h.dc()}if(2&e){var n=c.$implicit,t=c.index,o=h.pc();h.Nb(4),h.wc("src",n.avatar,h.Ec),h.Nb(3),h.Lc("\u4f5c\u8005\uff1a",n.author,""),h.Nb(4),h.Lc("\u53d1\u5e16\u65f6\u95f4: ",o.DateText(n.created),""),h.Nb(4),h.Lc("\u4fee\u6539\u65f6\u95f4: ",o.DateText(n.modified),""),h.Nb(5),h.Lc("",t+1," \u697c"),h.Nb(1),h.wc("ngIf",o.CheckAction(n,"anwser")),h.Nb(1),h.wc("ngIf",o.CheckAction(n,"modify")),h.Nb(1),h.wc("ngIf",o.CheckAction(n,"delete")),h.Nb(1),h.wc("ngIf",o.CheckAction(n,"frozen")),h.Nb(1),h.wc("ngIf",n.img),h.Nb(1),h.wc("ngIf",n.gua),h.Nb(1),h.wc("ngIf",n.bazi),h.Nb(1),h.wc("ngIf",o.ShowMe(n,"img")),h.Nb(3),h.wc("innerHtml",n.content,h.Dc)}}function $(e,c){if(1&e){var i=h.fc();h.ec(0,"div",40),h.ec(1,"sui-pagination",41),h.mc("pageChange",(function(e){return h.Cc(i),h.pc().PageIndex=e})),h.dc(),h.dc()}if(2&e){var n=h.pc();h.Nb(1),h.wc("collectionSize",n.PageSum)("pageSize",20)("maxSize",n.MaxPageButtons)("hasNavigationLinks",!0)("hasBoundaryLinks",!0)("page",n.PageIndex)}}var V,Y=((V=function(){function e(c,i,n,t,o,r,a){var s=this;_classCallCheck(this,e),this.loadingController=c,this.alertController=i,this.settings=n,this.forumservice=t,this.modalCtrl=o,this.route=r,this.router=a,this.pageindex=0,this.Pages=[0],this.PageSum=0,this.Titel="Topic Titel",this.VTopic=[],this.LoadSuccessed=!1,this.route.params.subscribe((function(e){s.forumid=e.forumid,s.topicid=e.topicid}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e;return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i=this;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.settings.WaitInit();case 2:if(c.t0=this.forumservice.ForumMG.Forumlist,c.t0){c.next=6;break}return c.next=6,this.forumservice.LoadForumList();case 6:return this.forum=this.forumservice.ForumMG.Forumlist.find((function(e){return e.id===i.forumid})),this.Titel=(null===(e=this.forum)||void 0===e?void 0:e.name)||this.forumid,this.user=this.settings.User||m.a,this.GuaConfig=this.settings.Gua,this.BaziConfig=this.settings.Bazi,c.next=13,this.loadingController.create({message:"\u6b63\u5728\u83b7\u53d6\u8bba\u575b\u5e16\u5b50...",duration:6e4});case 13:return this.loadingView=c.sent,c.next=16,this.forumservice.GetTopic(this.forumid,this.topicid);case 16:this.Topic=c.sent,this.PageIndex=0;case 18:case"end":return c.stop()}}),c,this)})))}},{key:"doRefresh",value:function(e){var c=this;this.VTopic=[],this.forumservice.GetTopic(this.forumid,this.topicid).then((function(e){return console.log("Tpoic",e),c.Topic=e,c.LoadAnswors(c.PageIndex)})).then((function(e){c.LoadSuccessed=e})).catch((function(e){console.log(e)})).finally((function(){e.target.complete()}))}},{key:"LoadAnswors",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i=this;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.forumservice.LoadAnswerList(this.topicid,this.forumid,e).then((function(e){return e&&Array.isArray(e.data)&&(i.PageSum=e.sum||0,i.VTopic=e.data,i.updateUserAvatar()),!0})).catch((function(e){return console.log("LoadAnswors Error",e),!1})));case 1:case"end":return c.stop()}}),c,this)})))}},{key:"DateText",value:function(e){if(!e)return"\u65e0";var c=new Date(e);return c.toChinaStr()+" ".concat(c.getHours(),":").concat(c.getMinutes(),":").concat(c.getSeconds())}},{key:"GetRoles",value:function(e){return e?this.settings.UserRolers(e):[]}},{key:"CheckAction",value:function(e,c){if(!e||!this.HasUser)return!1;var i=!1;return"modify"===c?i=(i=this.user.id===e.author||this.IsAdmin)&&!0!==e.frozen:"delete"===c?i=(i=this.user.id===e.author||this.IsAdmin)&&!0!==e.frozen:"frozen"===c?i=(i=this.user.id===e.author||this.IsAdmin)&&!0!==e.frozen:"anwser"===c&&(i=!0),i&&!(!0===e.deleted)}},{key:"ShowPanfu",value:function(e){this.router.navigate(["menu/topicpanfu/".concat(JSON.stringify(e))])}},{key:"EditTopic",value:function(e){var c;return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var n,t,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=void 0!==e.forumid,(t=n?null===(c=this.forum)||void 0===c?void 0:c.name:this.Topic.title)||(t=e.forumid||this.forumid),i.next=5,this.modalCtrl.create({component:d.a,componentProps:{MainTopic:n?e:null,VTopic:n?null:e,forumid:this.forumid,forumname:t,Private:!this.forum}});case 5:return o=i.sent,i.next=8,o.present();case 8:return i.next=10,o.onWillDismiss();case 10:case"end":return i.stop()}}),i,this)})))}},{key:"DeleteTopic",value:function(e,c){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var n=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:this.presentConfirm("\u5220\u9664",null,"\u786e\u5b9a\u5220\u9664\u6b64\u5e16\u5b50/\u53d1\u8a00\uff1f").then((function(i){return!0===i&&n.forumservice.DeleteTopic(e,c?null:n.Topic.id)})).then((function(e){e&&n.router.navigateByUrl(c?"menu/forum":"menu/topiclist/".concat(n.forumid))}));case 1:case"end":return i.stop()}}),i,this)})))}},{key:"AnswerTopic",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i,n;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return i=this.CreateTopic(e),c.next=3,this.modalCtrl.create({component:d.a,componentProps:{VTopic:i,forumid:this.forumid,forumname:this.Topic.title}});case 3:return n=c.sent,c.next=6,n.present();case 6:return c.next=8,n.onWillDismiss();case 8:case"end":return c.stop()}}),c,this)})))}},{key:"FrozenTopic",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i,n=this;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:i=!e,e=e||this.Topic,this.presentConfirm("\u5c01\u5b58",null,"\u5c01\u5b58\u53d1\u8a00\u540e\uff0c\u4e0d\u5141\u8bb8\u518d\u4fee\u6539\u3001\u5220\u9664\u3002\u5168\u697c\u5c01\u5b58\u540e\u4e0d\u5141\u8bb8\u8ddf\u8d34\u3002\u786e\u5b9a\u5c01\u5b58\u5417\uff1f").then((function(c){if(!0===c)return n.forumservice.UpdateTopic({frozen:!0},e.id,!n.forum)})).then((function(c){c&&(e.frozen=!0,e.deleted=!!i||e.deleted)})).catch((function(e){n.presentConfirm("\u64cd\u4f5c\u5931\u8d25",null,"\u5c01\u697c/\u53d1\u8a00\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff0c \u6216\u8005\u5411\u7248\u4e3b\u62a5\u544a\u3002")}));case 2:case"end":return c.stop()}}),c,this)})))}},{key:"SetTopOrGood",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i,n=this;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:i={},"\u7cbe\u534e"===e?i.good=!this.Topic.good:"\u7f6e\u9876"===e&&(i.top=(this.Topic.top+1)%2),this.forumservice.UpdateTopic(i,this.Topic.id,!this.forum).then((function(c){c&&("\u7cbe\u534e"===e?n.Topic.good=!n.Topic.good:"\u7f6e\u9876"===e&&(n.Topic.top=(n.Topic.top+1)%2))}));case 2:case"end":return c.stop()}}),c,this)})))}},{key:"ShowUserInfo",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.modalCtrl.create({component:p.a,componentProps:{Uerid:e}});case 2:return i=c.sent,c.next=5,i.present();case 5:return c.next=7,i.onWillDismiss();case 7:case"end":return c.stop()}}),c,this)})))}},{key:"ShowImageModal",value:function(e){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.modalCtrl.create({component:g,componentProps:{ImgSrc:e}});case 2:return i=c.sent,c.next=5,i.present();case 5:return c.next=7,i.onWillDismiss();case 7:case"end":return c.stop()}}),c,this)})))}},{key:"NavBack",value:function(){this.router.navigateByUrl("/menu/topiclist/".concat(this.forumid))}},{key:"ShowMe",value:function(e,c){return"img"===c?e&&e.img&&e.showImg:"gua"===c?e&&e.gua&&e.showgua:"bazi"===c&&e&&e.bazi&&e.showbazi}},{key:"ChangeImg",value:function(e,c){"img"===c?e.showImg=!e.showImg:"gua"===c?e.showGua=!e.showGua:"bazi"===c&&(e.showBazi=!e.showBazi)}},{key:"CreateTopic",value:function(e){var c=Date.now();return{id:"",created:c,modified:c,author:this.user.id,topic:this.Topic.id,gua:null,bazi:null,img:null,content:"",feedback:e||"",frozen:!1}}},{key:"updateUserAvatar",value:function(){var e=this;this.VTopic.forEach((function(c){e.forumservice.GetUserInfo(c.author).then((function(i){var n=(i||m.a).avatar||"";c.avatar=n.IsNullOrEmpty()?e.settings.Avatar(i.gender):n,c.showImg=!0,c.showGua=!0,c.showBazi=!0}))}))}},{key:"presentConfirm",value:function(e,c,i){return Object(u.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=!1,n.next=3,this.alertController.create({header:e||"\u63d0\u793a",subHeader:c||"",message:i,buttons:[{text:"\u786e\u5b9a",handler:function(){t=!0}},{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary",handler:function(){}}]});case 3:return o=n.sent,n.next=6,o.present();case 6:return n.next=8,o.onWillDismiss();case 8:return n.abrupt("return",Promise.resolve(t));case 9:case"end":return n.stop()}}),n,this)})))}},{key:"IsWeb",get:function(){return"web"===m.b}},{key:"HasUser",get:function(){return this.settings.HasUser&&this.user!==m.a}},{key:"MaxPageButtons",get:function(){return this.settings.DeviceWidth>=400?7:2}},{key:"PageIndex",get:function(){return this.pageindex},set:function(e){var c=this;this.pageindex=e,this.LoadAnswors(e).then((function(e){c.LoadSuccessed=e}))}},{key:"MaxHeight",get:function(){return Math.ceil(this.settings.DeviceHeight/2)}},{key:"IsAdmin",get:function(){if(!this.user||!this.forum)return!1;var e=256===this.user.roller;return this.forum&&this.Topic&&(e=e||this.forum.admin.includes(this.user.id)),e}}]),e}()).\u0275fac=function(e){return new(e||V)(h.Zb(s.bb),h.Zb(s.b),h.Zb(l.a),h.Zb(f.a),h.Zb(s.cb),h.Zb(a.a),h.Zb(a.g))},V.\u0275cmp=h.Tb({type:V,selectors:[["app-topicviewer"]],decls:19,vars:9,consts:[[4,"ngIf"],["color","medium"],[1,"ion-no-padding"],["slot","start"],["color","danger",4,"ngIf"],["slot","end"],[3,"click",4,"ngIf"],[3,"disabled","click"],["slot","fixed",3,"ionRefresh"],[4,"ngFor","ngForOf"],["class","ui very basic segment",4,"ngIf"],["color","primary"],["defaulthref","","text","\u8fd4\u56de"],["routerLink","/menu/forum"],["icon-only","","name","home"],["color","danger"],[3,"click"],["name","undo"],[3,"src"],[1,"ion-text-wrap"],["color","primary",3,"click"],[1,"ion-margin-end"],[3,"closeOthers",4,"ngIf"],["lines","none",3,"click",4,"ngIf"],["ion-padding-vertical","",2,"margin-bottom","1px",3,"innerHtml"],["color","secondary",1,"ion-margin-end",3,"click"],[1,"ion-margin-end",3,"color","click"],[3,"color","click"],[3,"closeOthers"],[3,"isOpen"],["title",""],[1,"dropdown","icon"],["content",""],[3,"Config","GuaText"],[3,"Config","BaziText"],["lines","none",3,"click"],[1,"img-container"],[3,"src","ngStyle"],[2,"padding-bottom","3px"],["lines","none"],[1,"ui","very","basic","segment"],[1,"ui","right","floated",3,"collectionSize","pageSize","maxSize","hasNavigationLinks","hasBoundaryLinks","page","pageChange"]],template:function(e,c){1&e&&(h.Hc(0,x,9,1,"ion-header",0),h.ac(1,"ion-text",1),h.ec(2,"ion-item-divider",2),h.ec(3,"ion-label",3),h.ec(4,"ion-text"),h.Jc(5),h.dc(),h.Hc(6,C,2,0,"ion-text",4),h.Hc(7,y,2,0,"ion-text",4),h.dc(),h.ec(8,"ion-buttons",5),h.Hc(9,I,2,0,"ion-button",6),h.ec(10,"ion-button",7),h.mc("click",(function(){return c.FrozenTopic(null)})),h.Jc(11,"\u5c01\u697c"),h.dc(),h.dc(),h.dc(),h.ec(12,"ion-content",2),h.ec(13,"ion-refresher",8),h.mc("ionRefresh",(function(e){return c.doRefresh(e)})),h.ac(14,"ion-refresher-content"),h.dc(),h.Hc(15,D,34,17,"div",0),h.ec(16,"ion-list",2),h.Hc(17,Z,32,14,"ion-item",9),h.Hc(18,$,2,6,"div",10),h.dc(),h.dc()),2&e&&(h.wc("ngIf",!c.IsWeb),h.Nb(5),h.Lc("\u9898\u76ee\uff1a",null==c.Topic?null:c.Topic.title,""),h.Nb(1),h.wc("ngIf",null==c.Topic?null:c.Topic.good),h.Nb(1),h.wc("ngIf",null==c.Topic?null:c.Topic.top),h.Nb(2),h.wc("ngIf",c.IsWeb),h.Nb(1),h.wc("disabled",!c.CheckAction(c.Topic,"frozen")),h.Nb(5),h.wc("ngIf",c.Topic),h.Nb(2),h.wc("ngForOf",c.VTopic),h.Nb(1),h.wc("ngIf",c.LoadSuccessed))},directives:[o.j,s.T,s.y,s.D,s.j,s.i,s.n,s.J,s.K,s.E,o.i,s.t,s.Y,s.f,s.g,s.W,s.gb,a.h,s.u,s.x,s.V,s.H,v.a,v.b,b.a,w.a,o.k,v.f],pipes:[k],styles:[".img-container[_ngcontent-%COMP%]{text-align:center;display:block}"]}),V),K=i("CGrG"),X=i("zioG"),q=i("uEAi"),Q=i("n7QD");i.d(c,"TopicviewerPageModule",(function(){return ie}));var ee,ce=[{path:"",component:Y}],ie=((ee=function e(){_classCallCheck(this,e)}).\u0275mod=h.Xb({type:ee}),ee.\u0275inj=h.Wb({factory:function(e){return new(e||ee)},imports:[[q.a,Q.a,X.b,v.e,o.b,r.c,s.Z,K.b,a.j.forChild(ce)]]}),ee)}}]);