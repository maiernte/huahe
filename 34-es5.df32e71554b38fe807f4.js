function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{lotG:function(t,e,n){"use strict";n.r(e);var i,o,c=n("ofXK"),r=n("3Pt+"),s=n("tyNb"),a=n("c7TG"),b=n("mrSG"),u=n("LTmD"),d=n("gTpY"),l=n("ylIl"),h=n("HULg"),f=n("+z1p"),g=(n("0eVs"),n("fXoL")),m=n("zioG"),v=((o=function(){function t(e){_classCallCheck(this,t),this.modalCtrl=e,this.Editor=f,this.EditorConfig={toolbar:["heading","|","bold","italic","bulletedList","numberedList","|","link","undo","redo"]}}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"onSave",value:function(){this.modalCtrl.dismiss(this.Content)}},{key:"onCancel",value:function(){this.modalCtrl.dismiss("cancel")}},{key:"onDelete",value:function(){this.modalCtrl.dismiss("delete")}}]),t}()).\u0275fac=function(t){return new(t||o)(g.Wb(a.db))},o.\u0275cmp=g.Qb({type:o,selectors:[["app-recordcontenteditor"]],inputs:{Content:"Content"},decls:23,vars:5,consts:[["color","secondary"],["slot","start"],[3,"click"],["name","close-circle"],["slot","end"],["name","save"],["scrollY","true"],[3,"ngModel","config","editor","ngModelChange"],["fill","clear","color","danger",3,"hidden","click"],["name","trash"]],template:function(t,e){1&t&&(g.Zb(0,"ion-header"),g.Zb(1,"ion-toolbar",0),g.Zb(2,"ion-buttons",1),g.Zb(3,"ion-button",2),g.hc("click",(function(){return e.onCancel()})),g.Xb(4,"ion-icon",3),g.Zb(5,"ion-text"),g.xc(6,"\u53d6\u6d88"),g.Yb(),g.Yb(),g.Yb(),g.Zb(7,"ion-title"),g.xc(8),g.Yb(),g.Zb(9,"ion-buttons",4),g.Zb(10,"ion-button",2),g.hc("click",(function(){return e.onSave()})),g.Xb(11,"ion-icon",5),g.Zb(12,"ion-text"),g.xc(13,"\u4fdd\u5b58"),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.Zb(14,"ion-content",6),g.Zb(15,"ckeditor",7),g.hc("ngModelChange",(function(t){return e.Content.text=t})),g.Yb(),g.Yb(),g.Zb(16,"ion-footer"),g.Zb(17,"ion-toolbar"),g.Zb(18,"ion-buttons",4),g.Zb(19,"ion-button",8),g.hc("click",(function(){return e.onDelete()})),g.Xb(20,"ion-icon",9),g.Zb(21,"ion-label"),g.xc(22,"\u5220\u9664"),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.Yb()),2&t&&(g.Mb(8),g.zc("\u7f16\u8f91\uff1a",e.Content.type,""),g.Mb(7),g.oc("ngModel",e.Content.text)("config",e.EditorConfig)("editor",e.Editor),g.Mb(4),g.oc("hidden",0===e.Content.time))},directives:[a.t,a.Z,a.j,a.i,a.u,a.U,a.X,a.n,m.a,r.c,r.d,a.r,a.D],styles:[""]}),o),p=((i=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"transform",value:function(t,e){return new Date(t).toChinaStr(e)}}]),t}()).\u0275fac=function(t){return new(t||i)},i.\u0275pipe=g.Vb({name:"chinadate",type:i,pure:!0}),i);function C(t,e){if(1&t&&g.Xb(0,"app-baziview",18),2&t){var n=g.jc();g.oc("Config",n.Config)("BaziText",n.Bazi)}}function x(t,e){if(1&t&&g.Xb(0,"app-guaview",19),2&t){var n=g.jc();g.oc("Config",n.Config)("GuaText",n.Gua)}}function y(t,e){if(1&t){var n=g.ac();g.Zb(0,"ion-item",20),g.hc("click",(function(){g.rc(n);var t=e.$implicit;return g.jc().EditContent(t)})),g.Zb(1,"ion-note",21),g.xc(2),g.Yb(),g.Zb(3,"ion-label",22),g.Xb(4,"ion-text",23),g.Zb(5,"p"),g.Zb(6,"small"),g.xc(7),g.kc(8,"chinadate"),g.Yb(),g.Yb(),g.Yb(),g.Yb()}if(2&t){var i=e.$implicit;g.Mb(2),g.yc(i.type),g.Mb(2),g.oc("innerHtml",i.text,g.sc),g.Mb(3),g.yc(g.lc(8,3,i.time,!0))}}var k,w=((k=function(){function t(e,n,i,o,c){var r=this;_classCallCheck(this,t),this.route=e,this.dbservice=n,this.setting=i,this.alertCtrl=o,this.modalCtrl=c,this.EditModul=!1,this.index=0,this.smallSymbol=!1,this.HiddenCode=!1,this.HiddenTitel="",this.route.params.subscribe((function(t){r.nodeid=t.nodeid,r.recid=t.recid}))}return _createClass(t,[{key:"ngOnInit",value:function(){return Object(b.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setting.WaitInit();case 2:return this.guaconfig=Object(u.b)(this.setting.Gua),this.baziconfig=Object(u.b)(this.setting.Bazi),this.content=[],t.next=7,this.dbservice.WaitInit();case 7:this.dbservice.GetRecordes(this.nodeid).then((function(t){e.recordes=t,e.updateRecord()})),this.dbservice.getNodes().then((function(t){var n=t.find((function(t){return t.id===e.nodeid}));e.nodename=n.name}));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"ShowHideCode",value:function(){this.HiddenCode=!this.HiddenCode,!0===this.HiddenCode&&(this.guaview?this.HiddenTitel="".concat(this.guaview.GuaInText," \u95ee: ").concat(this.Record.titel):this.baziview&&(this.HiddenTitel="".concat(this.Record.titel,"(").concat(this.baziview.Gender,"): ").concat(this.baziview.BaziInText)))}},{key:"NextRecord",value:function(t){this.index=this.index+t,this.recid=this.recordes[this.Index].id,this.updateRecord()}},{key:"AddContent",value:function(t){return Object(b.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.EditContent({type:t,time:0,text:""});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"EditContent",value:function(t){return Object(b.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:v,componentProps:{Content:Object(u.b)(t)}});case 2:return n=e.sent,e.next=5,n.present();case 5:return e.next=7,n.onWillDismiss();case 7:i=e.sent,"cancel"!==(o=i.data)&&("delete"===o?this.content=this.content.filter((function(e){return e!==t})):0===o.time?(o.time=Date.now(),this.content.push(o)):(t.time=Date.now(),t.text=o.text),"cancel"!==o&&(this.Record.content=JSON.stringify(this.content),this.dbservice.SaveRecord(this.Record.id,this.Record.node,{content:JSON.stringify(this.content)})));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"ChangSymbol",value:function(){!1===this.smallSymbol?(this.guaconfig.shensha=4,this.guaconfig.symbol=1,this.baziconfig.shensha=4):(this.guaconfig=Object(u.b)(this.setting.Gua),this.baziconfig=Object(u.b)(this.setting.Bazi)),this.smallSymbol=!this.smallSymbol,this.guaview&&this.guaview.Reflash(this.guaconfig),this.baziview&&this.baziview.Reflash(this.baziconfig)}},{key:"EidtTitel",value:function(){return Object(b.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,i,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=!1,t.next=3,this.alertCtrl.create({header:"\u95ee\u5ff5\uff0f\u540d\u5b57",inputs:[{name:"titel",type:"text",id:"titel-id",value:this.Record.titel}],buttons:[{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary"},{text:"\u786e\u5b9a",handler:function(){e=!0}}]});case 3:return n=t.sent,t.next=6,n.present();case 6:return t.next=8,n.onWillDismiss();case 8:i=t.sent,o=i.data,e&&(c=o.values.titel,this.Record.titel=c,this.guaview?(this.gua.question=c,this.Record.arg=JSON.stringify(this.gua),this.guaview.Titel="\u95ee\u5ff5\uff1a"+c):this.baziview&&(this.bazi.person=c,this.Record.arg=JSON.stringify(this.bazi),this.baziview.Person="".concat(c," (").concat(this.baziview.Gender,"\u9020)")),this.dbservice.SaveRecord(this.Record.id,this.Record.node,{titel:c,arg:this.Record.arg}));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"updateRecord",value:function(){var t=this.Record;8===t.type?(this.gua=JSON.parse(t.arg),this.bazi=null):16===t.type&&(this.bazi=JSON.parse(t.arg),this.gua=null),this.content=JSON.parse(t.content||"[]")}},{key:"Config",get:function(){return this.HasGua?this.guaconfig:this.HasBazi?this.baziconfig:null}},{key:"NodeName",get:function(){return this.nodename||"\u6848\u4f8b"}},{key:"Record",get:function(){var t=this;if(this.recordes){var e=this.recordes.find((function(e){return e.id===t.recid}));return this.index=this.recordes.indexOf(e),e}return null}},{key:"Gua",get:function(){return this.gua}},{key:"Bazi",get:function(){return this.bazi}},{key:"HasGua",get:function(){return!!this.Gua}},{key:"HasBazi",get:function(){return!!this.Bazi}},{key:"Index",get:function(){return this.index}},{key:"Length",get:function(){return(this.recordes||[]).length}},{key:"Content",get:function(){return this.content||[]}}]),t}()).\u0275fac=function(t){return new(t||k)(g.Wb(s.a),g.Wb(h.a),g.Wb(u.a),g.Wb(a.b),g.Wb(a.db))},k.\u0275cmp=g.Qb({type:k,selectors:[["app-recordviewer"]],viewQuery:function(t,e){var n;1&t&&(g.Ac(d.a,!0),g.Ac(l.a,!0)),2&t&&(g.qc(n=g.ic())&&(e.baziview=n.first),g.qc(n=g.ic())&&(e.guaview=n.first))},decls:43,vars:10,consts:[["slot","start",3,"hidden"],["defaulthref","","text","\u8fd4\u56de"],["slot","end"],[3,"click"],["name","md-options"],["name","md-code-working"],[3,"hidden"],[1,"ion-padding"],[3,"Config","BaziText",4,"ngIf"],[3,"Config","GuaText",4,"ngIf"],["lines","inset","detail","","class","ion-text-wrap",3,"click",4,"ngFor","ngForOf"],["size","small","slot","start","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-back"],["size","small",3,"click"],["name","add"],["name","md-clipboard"],["size","small","slot","end","fill","clear",3,"disabled","click"],["slot","icon-only","name","ios-arrow-forward"],[3,"Config","BaziText"],[3,"Config","GuaText"],["lines","inset","detail","",1,"ion-text-wrap",3,"click"],["slot","start"],[1,"ion-text-wrap"],[3,"innerHtml"]],template:function(t,e){1&t&&(g.Zb(0,"ion-header"),g.Zb(1,"ion-toolbar"),g.Zb(2,"ion-buttons",0),g.Xb(3,"ion-back-button",1),g.Yb(),g.Zb(4,"ion-title"),g.xc(5),g.Yb(),g.Zb(6,"ion-buttons",2),g.Zb(7,"ion-button",3),g.hc("click",(function(){return e.ChangSymbol()})),g.Xb(8,"ion-icon",4),g.Yb(),g.Zb(9,"ion-button",3),g.hc("click",(function(){return e.ShowHideCode()})),g.Xb(10,"ion-icon",5),g.Yb(),g.Yb(),g.Yb(),g.Yb(),g.Zb(11,"ion-item",6),g.Zb(12,"ion-label"),g.xc(13),g.Yb(),g.Yb(),g.Zb(14,"ion-content",7),g.Zb(15,"div",6),g.wc(16,C,1,2,"app-baziview",8),g.wc(17,x,1,2,"app-guaview",9),g.Yb(),g.Zb(18,"ion-list"),g.wc(19,y,9,6,"ion-item",10),g.Yb(),g.Yb(),g.Zb(20,"ion-footer"),g.Zb(21,"ion-toolbar"),g.Zb(22,"ion-button",11),g.hc("click",(function(){return e.NextRecord(-1)})),g.Xb(23,"ion-icon",12),g.Yb(),g.Zb(24,"ion-buttons"),g.Zb(25,"ion-button",13),g.hc("click",(function(){return e.AddContent("\u80cc\u666f")})),g.Xb(26,"ion-icon",14),g.Zb(27,"ion-text"),g.xc(28,"\u80cc\u666f"),g.Yb(),g.Yb(),g.Zb(29,"ion-button",13),g.hc("click",(function(){return e.AddContent("\u53cd\u9988")})),g.Xb(30,"ion-icon",14),g.Zb(31,"ion-text"),g.xc(32,"\u53cd\u9988"),g.Yb(),g.Yb(),g.Zb(33,"ion-button",13),g.hc("click",(function(){return e.AddContent("\u89e3\u8bfb")})),g.Xb(34,"ion-icon",14),g.Zb(35,"ion-text"),g.xc(36,"\u89e3\u8bfb"),g.Yb(),g.Yb(),g.Zb(37,"ion-button",13),g.hc("click",(function(){return e.EidtTitel()})),g.Xb(38,"ion-icon",15),g.Zb(39,"ion-text"),g.xc(40,"\u95ee\u5ff5"),g.Yb(),g.Yb(),g.Yb(),g.Zb(41,"ion-button",16),g.hc("click",(function(){return e.NextRecord(1)})),g.Xb(42,"ion-icon",17),g.Yb(),g.Yb(),g.Yb()),2&t&&(g.Mb(2),g.oc("hidden",e.EditModul),g.Mb(3),g.yc(e.NodeName),g.Mb(6),g.oc("hidden",!e.HiddenCode),g.Mb(2),g.yc(e.HiddenTitel),g.Mb(2),g.oc("hidden",e.HiddenCode),g.Mb(1),g.oc("ngIf",e.HasBazi),g.Mb(1),g.oc("ngIf",e.HasGua),g.Mb(2),g.oc("ngForOf",e.Content),g.Mb(3),g.oc("disabled",0===e.Index),g.Mb(19),g.oc("disabled",e.Index===e.Length-1))},directives:[a.t,a.Z,a.j,a.f,a.g,a.X,a.i,a.u,a.x,a.D,a.n,c.j,a.E,c.i,a.r,a.U,d.a,l.a,a.J],pipes:[p],styles:[""]}),k),Y=n("uEAi"),Z=n("n7QD");n.d(e,"RecordviewerPageModule",(function(){return M}));var z,R=[{path:"",component:w}],M=((z=function t(){_classCallCheck(this,t)}).\u0275mod=g.Ub({type:z}),z.\u0275inj=g.Tb({factory:function(t){return new(t||z)},imports:[[Y.a,Z.a,m.b,c.b,r.a,a.ab,s.i.forChild(R)]]}),z)}}]);