(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"+eMj":function(t,e,s){"use strict";s.r(e);var i=s("ofXK"),r=s("3Pt+"),o=s("tyNb"),n=s("c7TG"),a=s("mrSG"),u=s("LTmD"),c=s("PKx9"),d=s("Y6BA"),h=s("HULg"),l=s("lEof"),p=s("fXoL");function m(t,e){if(1&t&&(p.ec(0,"ion-menu-toggle",6),p.ec(1,"ion-item",7),p.ac(2,"ion-icon",8),p.ec(3,"ion-label"),p.Hc(4),p.dc(),p.dc(),p.dc()),2&t){const t=e.$implicit,s=p.pc();p.Nb(1),p.Qb("active-item",s.selectedPath.startsWith(t.url)),p.uc("routerLink",t.url),p.Nb(1),p.uc("name",t.icon),p.Nb(2),p.Jc(" ",t.title," ")}}let f=(()=>{class t{constructor(t,e,s,i,r,o,n){this.router=t,this.platform=e,this.toastController=s,this.forumservice=i,this.host=r,this.nanodb=o,this.settings=n,this.selectedPath="",this.pages=[{title:"\u6392\u76d8",url:"/menu/paipan",icon:"home"},{title:"\u7f57\u76d8",url:"/menu/compass",icon:"disc"},{title:"\u6848\u4f8b",url:"/menu/nodes",icon:"list"},{title:"\u8ba8\u8bba\u533a",url:"/menu/forum",icon:"chatbubbles"},{title:"\u7528\u6237",url:"/menu/user",icon:"person"},{title:"\u8bbe\u7f6e",url:"/menu/setting",icon:"settings"}],this.IsWebApp=!1}ngOnInit(){return Object(a.b)(this,void 0,void 0,(function*(){yield this.settings.WaitInit(),this.platform.platforms(),this.nanodb.initNano(),navigator.app||(this.IsWebApp=!0),this.settings.HasUser&&this.settings.User.id!==d.a.id&&(this.updateAppSetting(),this.forumservice.HoldPublicMessage().then(t=>{t>0&&this.presentToast(`\u60a8\u6709 ${t} \u6761\u672a\u8bfb\u6d88\u606f, \u8bf7\u53ca\u65f6\u67e5\u6536\u3002`,5e3)}),this.pages.insert(3,{title:"\u6211\u7684\u6d88\u606f",url:"/menu/messagelist/false",icon:"chatboxes"}))}))}get HasUser(){return this.settings.HasUser}updateAppSetting(){this.host.GetAppSetting().then(t=>{this.settings.AppConfig.appSetting=t.appSetting}).catch(t=>{console.log("Get AppSetting failed",t)})}closeApp(){navigator.app?navigator.app.exitApp():console.log("platforms",this.platform.platforms(),navigator)}presentToast(t,e){return Object(a.b)(this,void 0,void 0,(function*(){(yield this.toastController.create({message:t,duration:e,color:"secondary",position:"middle"})).present()}))}}return t.\u0275fac=function(e){return new(e||t)(p.Zb(o.g),p.Zb(n.fb),p.Zb(n.kb),p.Zb(c.a),p.Zb(l.a),p.Zb(h.a),p.Zb(u.a))},t.\u0275cmp=p.Tb({type:t,selectors:[["app-menu"]],viewQuery:function(t,e){var s;1&t&&p.Mc(o.j,!0),2&t&&p.wc(s=p.nc())&&(e.outlet=s.first)},decls:13,vars:2,consts:[["disabled","true","contentId","content"],["contentId","content"],["auto-hide","false",4,"ngFor","ngForOf"],["tappable","",3,"hidden","click"],["name","exit","slot","start"],["id","content"],["auto-hide","false"],["routerDirection","root",3,"routerLink"],["slot","start",3,"name"]],template:function(t,e){1&t&&(p.ec(0,"ion-split-pane",0),p.ec(1,"ion-menu",1),p.ec(2,"ion-header"),p.ec(3,"ion-toolbar"),p.ec(4,"ion-text"),p.Hc(5,"\u83dc\u5355"),p.dc(),p.dc(),p.dc(),p.ec(6,"ion-content"),p.ec(7,"ion-list"),p.Fc(8,m,5,5,"ion-menu-toggle",2),p.ec(9,"ion-item",3),p.mc("click",(function(){return e.closeApp()})),p.ac(10,"ion-icon",4),p.Hc(11," \u9000\u51fa "),p.dc(),p.dc(),p.dc(),p.dc(),p.ac(12,"ion-router-outlet",5),p.dc()),2&t&&(p.Nb(8),p.uc("ngForOf",e.pages),p.Nb(1),p.uc("hidden",e.IsWebApp))},directives:[n.T,n.G,n.t,n.Z,n.U,n.n,n.E,i.i,n.x,n.u,n.L,n.I,n.hb,o.h,n.D],styles:["ion-menu[_ngcontent-%COMP%]{--max-width:200px}"]}),t})();s.d(e,"MenuPageModule",(function(){return b}));const g=[{path:"",component:f,children:[{path:"paipan",loadChildren:"../paipan/paipan.module#PaipanPageModule"},{path:"recordes/:id",loadChildren:"../recordes/recordes.module#RecordesPageModule"},{path:"nodes",loadChildren:"../nodes/nodes.module#NodesPageModule"},{path:"forum",loadChildren:"../../forum/forum/forum.module#ForumPageModule"},{path:"topiclist/:forumid",loadChildren:"../../forum/topiclist/topiclist.module#TopiclistPageModule"},{path:"topicdetail/:forumid/:topicid",loadChildren:"../../forum/topicviewer/topicviewer.module#TopicviewerPageModule"},{path:"topicpanfu/:arg",loadChildren:"../../forum/panfuviewer/panfuviewer.module#PanfuviewerPageModule"},{path:"messagelist/:naviback",loadChildren:"../../forum/messagelist/messagelist.module#MessagelistPageModule"},{path:"user",loadChildren:"../../user/userprofil/userprofil.module#UserprofilPageModule"},{path:"searchuser",loadChildren:"../../user/searchuser/searchuser.module#SearchuserPageModule"},{path:"setting",loadChildren:"../setting/setting.module#SettingPageModule"},{path:"recordview/:nodeid/:recid",loadChildren:"../recordviewer/recordviewer.module#RecordviewerPageModule"},{path:"compass",loadChildren:"../compass/compass.module#CompassPageModule"}]}];let b=(()=>{class t{}return t.\u0275mod=p.Xb({type:t}),t.\u0275inj=p.Wb({factory:function(e){return new(e||t)},imports:[[i.b,r.c,n.ab,o.i.forChild(g)]]}),t})()},PKx9:function(t,e,s){"use strict";var i=s("mrSG"),r=s("LTmD"),o=s("lEof");s("aGhr");class n{constructor(){this.topics=[]}Reset(){this.topics=[]}GetPage(t,e=0){const s=this.topics.find(s=>s.forumid===t&&e===s.page);return s?{data:s.items,sum:s.sum}:null}SetPage(t,e,s,i){const r=this.topics.find(s=>s.forumid===t&&e===s.page);r?r.items=s:this.topics.push({forumid:t,page:e,items:s,sum:i})}GetTopic(t){for(const e of this.topics){const s=e.items.find(e=>e.id===t);if(s)return s}return null}SetTopic(t,e){const s=this.GetPage(e,0);s?s.data.insert(0,t):this.SetPage(e,0,[t],1)}DeleteTopic(t,e){if(e);else for(const s of this.topics)s.items.find(e=>e.id===t)&&(s.items=s.items.filter(e=>e.id!==t))}UpdateTopic(t){const e=this.GetTopic(t.id);if(e)for(let s in t)e[s]=t[s]}}var a=s("Y6BA"),u=(s("0eVs"),s("fXoL"));s.d(e,"a",(function(){return c}));let c=(()=>{class t{constructor(t,e){this.settings=t,this.host=e,this.vusers=[],this.currentTopics=[],this.ForumMG=new n,this.user=this.settings.User||a.a}get VUsers(){return this.vusers=this.vusers||[],this.vusers=this.vusers.filter(t=>!!t)||[],this.vusers}set VUsers(t){this.vusers=t||[]}ForumList(t=!1){return Object(i.b)(this,void 0,void 0,(function*(){return this.ForumMG.Forumlist&&!1===t?Promise.resolve(this.ForumMG.Forumlist):(yield this.settings.WaitInit(),this.user=this.settings.User||a.a,this.LoadForumList())}))}LoadTopicList(t,e,s){return Object(i.b)(this,void 0,void 0,(function*(){let i=t||"forum_"+s;i=-2===s?t+"good":i;const r=-1===s?s:e,o=this.ForumMG.GetPage(i,r);if(o)return Promise.resolve(o);const n={func:"TopicList",forumid:t,params:{filter:{},startColumn:20*e,private:!1}};return-1===s?n.params.filter.top=1:-2===s?n.params.filter.good=!0:-3===s?(n.params.filter.author=this.user.id,n.params.filter.topic=null):-4===s?(n.params.filter.author=this.user.id,n.params.filter.topic=null,n.params.private=!0):-5===s?(n.params.filter.forumid=this.user.id,n.params.filter.topic=null,n.params.private=!0):n.params.filter.top=0,t&&(n.params.filter.forumid=t),this.host.ForumRequest(this.user.id,this.user.password,n).then(t=>(t&&t.data&&this.ForumMG.SetPage(i,r,t.data,t.sum),t)).catch(t=>Promise.reject(t))}))}LoadAnswerList(t,e,s){return Object(i.b)(this,void 0,void 0,(function*(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"TopicList",forumid:e,params:{filter:{topic:t},sort:"created",startColumn:20*s,direction:1}}).then(t=>t).catch(t=>Promise.reject(t))}))}NewTopic(t,e){return Object(i.b)(this,void 0,void 0,(function*(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"NewTopic",forumid:t,params:e}).then(t=>t).catch(t=>Promise.reject(t))}))}GetTopic(t,e){return Object(i.b)(this,void 0,void 0,(function*(){const t=this.ForumMG.GetTopic(e);if(t)return Promise.resolve(t);Promise.reject("????")}))}UpdatForum(t,e){return Object(i.b)(this,void 0,void 0,(function*(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"UpdateForum",params:{id:e,data:t}}).then(t=>t).catch(t=>(console.log("updat failed",t),Promise.reject(t)))}))}UpdateTopic(t,e,s){return Object(i.b)(this,void 0,void 0,(function*(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"Update",params:{id:e,private:s,data:t}}).then(t=>t).catch(t=>(console.log("updat failed",t),Promise.reject(t)))}))}GetUserInfo(t,e=-1){const s=this.VUsers.find(e=>e.id===t);return s?Promise.resolve(s):this.host.ForumRequest(this.user.id,this.user.password,{func:"GetVUser",author:t,roller:e}).then(t=>(this.VUsers.push(t),t)).catch(t=>Promise.reject(t))}DeleteTopic(t,e){return this.host.ForumRequest(this.user.id,this.user.password,{func:"DeleteTopic",params:{topicid:t}}).then(s=>(this.ForumMG.DeleteTopic(t,e),s)).catch(t=>Promise.reject(t))}SendMessage(t){return this.host.ForumRequest(this.user.id,this.user.password,{func:"SendMessage",params:{message:t}}).then(t=>t).catch(t=>Promise.reject(t))}LoadMessages(t,e){return Object(i.b)(this,void 0,void 0,(function*(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"MessageList",params:{pageindex:t,forme:e}}).then(t=>t).catch(t=>Promise.reject(t))}))}DeleteMessage(t,e){return Object(i.b)(this,void 0,void 0,(function*(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"DeleteMessage",params:{msgid:t,todelete:e}}).then(t=>t).catch(t=>Promise.reject(t))}))}HoldPublicMessage(){return Object(i.b)(this,void 0,void 0,(function*(){return yield this.initial(),this.host.ForumRequest(this.user.id,this.user.password,{func:"HoldPublicMsg"}).then(t=>t).catch(t=>Promise.reject(t))}))}UpgradUser(t,e){return Object(i.b)(this,void 0,void 0,(function*(){return yield this.initial(),this.host.ForumRequest(this.user.id,this.user.password,{func:"UpgradeUser",params:{id:t,data:e}}).then(t=>t).catch(t=>Promise.reject(t))}))}initial(){return Object(i.b)(this,void 0,void 0,(function*(){return this.user||(yield this.settings.WaitInit(),this.user=this.settings.User),!0}))}LoadForumList(){return this.host.ForumRequest(this.user.id,this.user.password,{func:"ForumList"}).then(t=>(this.ForumMG.Forumlist=t,t)).catch(t=>Promise.reject(t))}}return t.\u0275fac=function(e){return new(e||t)(u.ic(r.a),u.ic(o.a))},t.\u0275prov=u.Vb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},aGhr:function(t,e){}}]);